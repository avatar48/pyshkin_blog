!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=218)}({108:function(e,t,n){"use strict";n.r(t),n.d(t,"KEY",function(){return i}),n.d(t,"addEvent",function(){return o}),n.d(t,"removeEvent",function(){return s}),n.d(t,"triggerEvent",function(){return c}),n.d(t,"cancelEvent",function(){return d}),n.d(t,"stopEvent",function(){return u}),n.d(t,"normEvent",function(){return p}),n.d(t,"checkEvent",function(){return l}),n.d(t,"checkKeyboardEvent",function(){return _}),n.d(t,"checkOver",function(){return f});var a=n(316),r=n(52),i={LEFT:37,UP:38,RIGHT:39,DOWN:40,DEL:8,TAB:9,RETURN:13,ENTER:13,ESC:27,PAGEUP:33,PAGEDOWN:34,SPACE:32,CTRL:17,ALT:18,SHIFT:16};function o(e,t,n,i,o,s){if((e=Object(a.ge)(e))&&3!=e.nodeType&&8!=e.nodeType){var c,u=o?((c=function(e){var t=e.data;e.data=o;var a=n.apply(this,[e]);return e.data=t,a}).handler=n,c):n;e.setInterval&&e!==window&&(e=window);var l=Object(a.data)(e,"events")||Object(a.data)(e,"events",{}),_=Object(a.data)(e,"handle")||Object(a.data)(e,"handle",function(e){return function(){(function(e){e=p(e);var t=Array.from(arguments);t[0]=e;var n=Object(a.data)(this,"events");if(!n||"string"!=typeof e.type||!n[e.type]||!n[e.type].length)return;var r=(n[e.type]||[]).slice();for(var i in r)if(r.hasOwnProperty(i)){if("mouseover"===e.type||"mouseout"===e.type){for(var o=e.relatedElement;o&&o!==this;)o=o.parentNode;if(o===this)continue}var s=r[i].apply(this,t);if(!1!==s&&-1!==s||d(e),-1===s)return!1}}).apply(e,arguments)}}(e));Object(r.each)(t.split(/\s+/),function(t,n){l[n]||(l[n]=[],!i&&e.addEventListener?e.addEventListener(n,_,s):!i&&e.attachEvent&&e.attachEvent("on"+n,_)),l[n].push(u)})}}function s(e,t,n,i){if(void 0===i&&(i=!1),e=Object(a.ge)(e)){var o=Object(a.data)(e,"events");if(o)if("string"==typeof t)Object(r.each)(t.split(/\s+/),function(t,s){if(Object(r.isArray)(o[s])){var c=o[s].length;if(Object(r.isFunction)(n)){for(var d=c-1;d>=0;d--)if(o[s][d]&&(o[s][d]===n||o[s][d].handler===n)){o[s].splice(d,1),c--;break}}else{for(var u=0;u<c;u++)delete o[s][u];c=0}c||(e.removeEventListener?e.removeEventListener(s,Object(a.data)(e,"handle"),i):e.detachEvent&&e.detachEvent("on"+s,Object(a.data)(e,"handle")),delete o[s])}}),Object(r.isEmpty)(o)&&(Object(a.removeData)(e,"events"),Object(a.removeData)(e,"handle"));else for(var c in o)o.hasOwnProperty(c)&&s(e,c)}}function c(e,t,n,i){e=Object(a.ge)(e);var o=Object(a.data)(e,"handle");if(o){var s=function(){return o.call(e,Object(r.extend)(n||{},{type:t,target:e}))};i?s():setTimeout(s,0)}}function d(e){if(!(e=e||window.event))return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.cancelBubble=!0,e.returnValue=!1,!1}function u(e){if(!(e=e||window.event))return!1;for(;e.originalEvent;)e=e.originalEvent;return e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,!1}function p(e){var t=e=e||window.event;if((e=Object(r.clone)(t)).originalEvent=t,e.target||(e.target=e.srcElement||document),3==e.target.nodeType&&(e.target=e.target.parentNode),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===e.target),null==e.pageX&&null!=e.clientX){var n=document.documentElement,a=bodyNode;e.pageX=e.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n.clientLeft||0),e.pageY=e.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n.clientTop||0)}return!e.which&&(e.charCode||0===e.charCode?e.charCode:e.keyCode)&&(e.which=e.charCode||e.keyCode),!e.metaKey&&e.ctrlKey?e.metaKey=e.ctrlKey:!e.ctrlKey&&e.metaKey&&browser.mac&&(e.ctrlKey=e.metaKey),!e.which&&e.button&&(e.which=1&e.button?1:2&e.button?3:4&e.button?2:0),e}function l(e){var t=e||window.event;return t&&("click"===t.type||"mousedown"===t.type||"mouseup"===t.type)&&(t.which>1||t.button>1||t.ctrlKey||t.shiftKey||browser.mac&&t.metaKey)||!1}function _(e){if(!(e=p(e))||!e.target)return!1;if(!e.screenX)return!0;var t=Object(a.getSize)(e.target),n=Object(a.getXY)(e.target),r=e.pageX-n[0],i=e.pageY-n[1];return r<-1||r>t[0]+1||i<-1||i>t[1]+1||Math.abs(e.pageX-n[0]-t[0]/2)<1&&Math.abs(e.pageY-n[1]-t[1]/2)<1}function f(e,t){if(!e)return!0;e=e.originalEvent||e,t=t||e.target;var n=e.fromElement||e.relatedTarget;if(!n||n===t||n===t.parentNode)return!0;for(;n!==t&&n.parentNode&&n.parentNode!==bodyNode;)n=n.parentNode;return n!==t}window.KEY=i,window.addEvent=o,window.removeEvent=s,window.triggerEvent=c,window.cancelEvent=d,window.stopEvent=u,window.normEvent=p,window.checkEvent=l,window.checkKeyboardEvent=_,window.checkOver=f},130:function(e,t,n){"use strict";n.r(t),n.d(t,"parseLatin",function(){return i}),n.d(t,"parseCyr",function(){return o}),n.d(t,"parseLatKeys",function(){return s}),n.d(t,"langNumeric",function(){return c}),n.d(t,"langSex",function(){return d}),n.d(t,"langStr",function(){return u}),n.d(t,"addLangKeys",function(){return p}),n.d(t,"getLang",function(){return l}),n.d(t,"langDate",function(){return _}),n.d(t,"getShortDate",function(){return f}),n.d(t,"getShortDateOrTime",function(){return v}),n.d(t,"langWordNumeric",function(){return g}),n.d(t,"getDateText",function(){return h}),n.d(t,"getBigDateNew",function(){return m}),n.d(t,"getSmDate",function(){return w});var a=n(295),r=n(52);function i(e){for(var t=["yo","zh","kh","ts","ch","sch","shch","sh","eh","yu","ya","YO","ZH","KH","TS","CH","SCH","SHCH","SH","EH","YU","YA","'"],n=["ё","ж","х","ц","ч","щ","щ","ш","э","ю","я","Ё","Ж","Х","Ц","Ч","Щ","Щ","Ш","Э","Ю","Я","ь"],a=e,r=0,i=t.length;r<i;r++)a=a.split(t[r]).join(n[r]);for(var o="abvgdezijklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ",s=0,c=o.length;s<c;s++)a=a.split(o.charAt(s)).join("абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ".charAt(s));return a===e?null:a}function o(e){for(var t=["yo","zh","kh","ts","ch","sch","shch","sh","eh","yu","ya","YO","ZH","KH","TS","CH","SCH","SHCH","SH","EH","YU","YA","'"],n=["ё","ж","х","ц","ч","щ","щ","ш","э","ю","я","Ё","Ж","Х","Ц","Ч","Щ","Щ","Ш","Э","Ю","Я","ь"],a="абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ",r=e,i=0;i<n.length;i++)r=r.split(n[i]).join(t[i]);for(var o=0;o<a.length;o++)r=r.split(a.charAt(o)).join("abvgdezijklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ".charAt(o));return r===e?null:r}function s(e){for(var t="qwertyuiop[]asdfghjkl;'zxcvbnm,./`",n=e,a=0;a<t.length;a++)n=n.split(t.charAt(a)).join("йцукенгшщзхъфывапролджэячсмитьбю.ё".charAt(a));return n==e?null:n}function c(e,t,n){if(!t||!window.langConfig)return e;var a=void 0;if(Object(r.isArray)(t)?(a=t[1],e!=Math.floor(e)?a=t[langConfig.numRules.float]:Object(r.each)(langConfig.numRules.int,function(n,i){if("*"==i[0])return a=t[i[2]],!1;var o=i[0]?e%i[0]:e;return-1!=Object(r.indexOf)(i[1],o)?(a=t[i[2]],!1):void 0})):a=t,n){for(var i=e.toString().split("."),o=[],s=i[0].length-3;s>-3;s-=3)o.unshift(i[0].slice(s>0?s:0,s+3));i[0]=o.join(langConfig.numDel),e=i.join(langConfig.numDec)}return a=(a||"%s").replace("%s",e)}function d(e,t){if(!Object(r.isArray)(t))return t;var n=t[1];return window.langConfig?(Object(r.each)(langConfig.sexRules,function(a,r){return"*"==r[0]?(n=t[r[1]],!1):e==r[0]&&t[r[1]]?(n=t[r[1]],!1):void 0}),n):n}function u(e){for(var t=arguments,n=t.length,a=e+"",r=1;r<n;r+=2){var i="%"===t[r][0]?t[r]:"{"+t[r]+"}";a=a.replace(i,t[r+1])}return a}function p(e,t){var n=t?window:window.cur;n.lang?Object(r.extend)(n.lang,e):n.lang=e}function l(){try{var e=Array.from(arguments),t=e.shift();if(!t)return"...";var n=window.cur.lang&&window.cur.lang[t]||window.lang&&window.lang[t]||window.langpack&&window.langpack[t]||window[t];if(!n){var a=t.split("_");return a.shift(),a.join(" ")}return Object(r.isFunction)(n)?n.apply(null,e):void 0===e[0]&&!Object(r.isArray)(n)||"raw"===e[0]?n:c(e[0],n,e[1])}catch(e){debugLog("lang error:"+e.message+"("+Array.from(arguments).join(", ")+")")}}function _(e,t,n,i,o,s){var c=void 0;if(s||(s=""),Object(r.isArray)(t)||(t=["",t,t,t,t]),"number"==typeof e||"string"==typeof e?(e>2147483646e3&&(e=0),e+=n,c=new Date(e)):c=e,o)t=t[1];else{var d="";!(d=Object(a.isToday)(c)?t[3]:Object(a.isYesterday)(c)?t[2]:Object(a.isTomorrow)(c)?t[4]:t[1])&&t[1]&&(d=t[1]),t=d}var u={hours:c.getHours(),minutes:c.getMinutes(),seconds:c.getSeconds(),day:c.getDate(),month:c.getMonth()+1,year:c.getFullYear()},p="";switch(3===vk.lang&&(p=c.getHours()>11?"pm":"am",u.hours=c.getHours()%12==0?12:c.getHours()%12),vk.lang){case 1:switch(c.getHours()){case 11:t=t.replace(" о "," об ");break;case 0:t=t.replace(" о "," в ")}break;case 3:!Object(a.isToday)(c)||Object(a.isYesterday)(c)||Object(a.isTomorrow)(c)||(t=s+t);break;case 12:case 73:1==c.getHours()&&(t=t.replace(" &#224;s "," &#224; "))}return 68===vk.lang&&(u.year=u.year+543),t.replace("{hour}",u.hours).replace("{num_hour}",Object(a.leadingZero)(u.hours)).replace("{minute}",Object(a.leadingZero)(u.minutes)).replace("{day}",u.day).replace("{num_day}",Object(a.leadingZero)(u.day)).replace("{month}",i[u.month]).replace("{year}",u.year).replace("{short_year}",u.year%100).replace("{second}",Object(a.leadingZero)(u.seconds)).replace("{am_pm}",p)}function f(e,t,n,a,r){e*=1e3,void 0===n&&(n=!0),void 0===a&&(a=l("months_of","raw")),t*=1e3;var i=Date.now(),o=new Date(i),s=new Date(e+t);return!r&&e>i&&e-i<864e5&&o.getDate()===s.getDate()?_(e,"{hour}:{minute} {am_pm}",t,[],!n):s.getYear()!==o.getYear()||e<i-157248e5?_(e,l("global_date","raw"),t,a,!n):_(e,l("global_short_date","raw"),t,a,!n)}function v(e,t,n,r){return Object(a.isToday)(new Date(1e3*e+1e3*t))?_(1e3*e,"{hour}:{minute} {am_pm}",1e3*t,[],!n):f(e,t,n,r)}function g(e,t,n){return Object(r.isArray)(t)&&e<t.length?t[e]:c(e,n)}function h(e,t){e+=t;var n=parseInt(Date.now()/1e3)-e,a="";if(n<60)a=l("global_just_now");else if(n<3600){a=g(Object(r.intval)(n/60),l("global_word_mins_ago","raw"),l("global_mins_ago","raw"))}else if(n<14400){a=g(Object(r.intval)(n/3600),l("global_word_hours_ago","raw"),l("global_hours_ago","raw"))}else a=m(e,0,!0,"_l");return a}function m(e,t,n,a){void 0===n&&(n=!0),void 0===t&&(t=0),void 0===a&&(a=""),t*=1e3;var r=new Date(1e3*e),i=new Date;return r.getFullYear()!==i.getFullYear()&&r.getTime()<i.getTime()-1728e5||Math.abs(r.getTime()-i.getTime())>157248e5?_(1e3*e,l("global_date","raw"),t,l("months_sm_of"),!n):_(1e3*e,l("global_short_date_time"+a,"raw"),t,l("months_sm_of"),!n)}function w(e,t,n){void 0===n&&(n=!0),void 0===t&&(t=0);var a=new Date,r=a.getFullYear(),i=a.getMonth(),o=new Date(1e3*e),s=o.getFullYear(),c=o.getMonth();return _(1e3*e,l(s<r&&(i>1||c<9||r-s>=2)?"global_date":"global_short_date_time","raw"),t,l("months_sm_of","raw"),!n)}window.parseLatin=i,window.parseCyr=o,window.parseLatKeys=s,window.langNumeric=c,window.langSex=d,window.langStr=u,window.addLangKeys=p,window.getLang=l,window.langDate=_,window.getShortDate=f,window.getShortDateOrTime=v,window.langWordNumeric=g,window.getDateText=h,window.getBigDateNew=m,window.getSmDate=w},218:function(e,t,n){e.exports=n(401)},295:function(e,t,n){"use strict";function a(e){var t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function r(e){return a(new Date(e.getTime()+864e5))}function i(e){return a(new Date(e.getTime()-864e5))}function o(e,t){var n=new Date(e),a=new Date(t);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()&&n.getDate()===a.getDate()}function s(e){return e>=10?e:"0"+e}function c(e,t){var n=void 0;e=Math.max(e,0);var a=Math.floor(e%60);n=a<10?"0"+a:a;var r=(e=Math.floor(e/60))%60;return n=r+":"+n,((e=Math.floor(e/60))>0||t)&&(r<10&&(n="0"+n),n=e+":"+n),n}n.r(t),n.d(t,"isToday",function(){return a}),n.d(t,"isYesterday",function(){return r}),n.d(t,"isTomorrow",function(){return i}),n.d(t,"isSameDate",function(){return o}),n.d(t,"leadingZero",function(){return s}),n.d(t,"formatTime",function(){return c})},316:function(e,t,n){"use strict";n.r(t),n.d(t,"ge",function(){return i}),n.d(t,"geByTag",function(){return o}),n.d(t,"geByTag1",function(){return s}),n.d(t,"geByClass",function(){return c}),n.d(t,"geByClass1",function(){return d}),n.d(t,"gpeByClass",function(){return u}),n.d(t,"domQuery",function(){return p}),n.d(t,"domQuery1",function(){return l}),n.d(t,"domClosest",function(){return _}),n.d(t,"domClosestByTag",function(){return f}),n.d(t,"gpeByTag",function(){return v}),n.d(t,"ce",function(){return g}),n.d(t,"re",function(){return C}),n.d(t,"se",function(){return A}),n.d(t,"sech",function(){return x}),n.d(t,"rs",function(){return E}),n.d(t,"psr",function(){return k}),n.d(t,"domReplaceEl",function(){return S}),n.d(t,"domEL",function(){return B}),n.d(t,"domNS",function(){return T}),n.d(t,"domPS",function(){return D}),n.d(t,"domFC",function(){return j}),n.d(t,"domLC",function(){return O}),n.d(t,"domPN",function(){return P}),n.d(t,"domChildren",function(){return F}),n.d(t,"domInsertBefore",function(){return L}),n.d(t,"domInsertAfter",function(){return q}),n.d(t,"domByClass",function(){return M}),n.d(t,"domData",function(){return R}),n.d(t,"domChildIndex",function(){return I}),n.d(t,"domCA",function(){return N}),n.d(t,"domClosestSibling",function(){return H}),n.d(t,"matchesSelector",function(){return V}),n.d(t,"isHover",function(){return U}),n.d(t,"isAncestor",function(){return z}),n.d(t,"getScroll",function(){return Y}),n.d(t,"domClosestPositioned",function(){return W}),n.d(t,"domClosestOverflowHidden",function(){return K}),n.d(t,"show",function(){return X}),n.d(t,"hide",function(){return G}),n.d(t,"isVisible",function(){return $}),n.d(t,"clientHeight",function(){return Z}),n.d(t,"getClientRectOffsetY",function(){return Q}),n.d(t,"toggle",function(){return J}),n.d(t,"boundingRectEnabled",function(){return ee}),n.d(t,"getXYRect",function(){return te}),n.d(t,"getXY",function(){return ne}),n.d(t,"isWindow",function(){return ae}),n.d(t,"getSize",function(){return re}),n.d(t,"getW",function(){return ie}),n.d(t,"getH",function(){return oe}),n.d(t,"hasClass",function(){return se}),n.d(t,"addClass",function(){return ce}),n.d(t,"addClassDelayed",function(){return de}),n.d(t,"removeClass",function(){return ue}),n.d(t,"removeClassDelayed",function(){return pe}),n.d(t,"toggleClass",function(){return le}),n.d(t,"toggleClassDelayed",function(){return _e}),n.d(t,"replaceClass",function(){return fe}),n.d(t,"getStyle",function(){return ve}),n.d(t,"setStyle",function(){return ge}),n.d(t,"setStyleDelayed",function(){return he}),n.d(t,"setPseudoStyle",function(){return me}),n.d(t,"data",function(){return we}),n.d(t,"attr",function(){return ye}),n.d(t,"removeAttr",function(){return be}),n.d(t,"removeData",function(){return Ce}),n.d(t,"cleanElems",function(){return Ae}),n.d(t,"setTitle",function(){return xe}),n.d(t,"getZoom",function(){return Ee}),n.d(t,"val",function(){return ke}),n.d(t,"elfocus",function(){return Se}),n.d(t,"traverseParent",function(){return Be}),n.d(t,"setDocumentTitle",function(){return De}),n.d(t,"lockDocumentTitle",function(){return je}),n.d(t,"initDomScripts",function(){return Oe});var a=n(52),r=n(108),i=function(e){return"string"==typeof e||"number"==typeof e?document.getElementById(e):e};function o(e,t){return(t=i(t)||document).getElementsByTagName(e)}function s(e,t){return(t=i(t)||document).querySelector&&t.querySelector(e)||o(e,t)[0]}function c(e,t,n){return t=i(t)||document,n=n||"*",e=("."+e).replace(/\s+/gm,"."),Array.prototype.slice.call(t.querySelectorAll(n+e))}function d(e,t,n){return t=i(t)||document,n=n||"*",t.querySelector&&t.querySelector(n+("."+e).replace(/\s+/gm,"."))||c(e,t,n)[0]}function u(e,t,n){if(!(t=i(t)))return null;for(;n!==t&&(t=t.parentNode);)if(se(t,e))return t;return null}function p(e,t){return(t||document).querySelectorAll(e)}function l(e,t){return(t||document).querySelector(e)}function _(e,t){return se(t,e)?t:u(e,t)}function f(e,t){return e=e.toUpperCase(),t.nodeType===Node.ELEMENT_NODE&&t.tagName.toUpperCase()===e?t:v(e,t)}function v(e,t){if(!(t=i(t)))return null;for(e=e.toUpperCase();t=t.parentNode;)if(t.tagName&&t.tagName.toUpperCase()===e)return t;return null}function g(e,t,n){var r=document.createElement(e);return t&&Object(a.extend)(r,t),n&&ge(r,n),r}var h,m,w,y,b=(h=document,m=h.createDocumentFragment(),w=h.createElement("div"),y=h.createRange&&h.createRange(),m.appendChild(w),y&&y.selectNodeContents(w),y&&y.createContextualFragment?function(e){return e?y.createContextualFragment(e):h.createDocumentFragment()}:function(e){if(!e)return h.createDocumentFragment();w.innerHTML=e;for(var t=h.createDocumentFragment();w.firstChild;)t.appendChild(w.firstChild);return t});function C(e){return(e=i(e))&&e.parentNode&&e.parentNode.removeChild(e),e}var A=function(e){return j(g("div",{innerHTML:e}))},x=function(e){return F(g("div",{innerHTML:e}))};function E(e,t){return Object(a.each)(t,function(t,n){e=e.replace(new RegExp("%"+t+"%","g"),(void 0===n?"":n).toString().replace(/\$/g,"&#036;"))}),e}function k(e){return"https:"!==locProtocol?e:e=(e=(e=(e=(e=e.replace(/http:\/\/(cs(\d+)\.vk\.me\/c(\d+)\/)/gi,"https://$1")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/c(\d+)\/(v\d+\/|[a-z0-9\/_:\-]+\.jpg)/gi,"https://pp.vk.me/c$3/$4")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/([a-z0-9\/_:\-]+\.jpg)/gi,"https://pp.vk.me/c$1/$3")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\//gi,"https://ps.vk.me/c$1/")).replace(/http:\/\/video(\d+)\.vkadre\.ru\//gi,"https://ps.vk.me/v$1/")}function S(e,t){return Object(a.isString)(t)&&(t=A(t)),P(e).replaceChild(t,e),t}function B(e,t){for(t=t?"previousSibling":"nextSibling";e&&!e.tagName;)e=e[t];return e}var T=function(e){return B((e||{}).nextSibling)},D=function(e){return B((e||{}).previousSibling,1)},j=function(e){return B((e||{}).firstChild)},O=function(e){return B((e||{}).lastChild,1)},P=function(e){return(e||{}).parentNode};function F(e){for(var t=[],n=e.childNodes,a=0;a<n.length;a++)n[a].tagName&&t.push(n[a]);return t}function L(e,t){var n=P(t);return n&&n.insertBefore(e,t)}function q(e,t){var n=P(t);return n&&n.insertBefore(e,T(t))}function M(e,t){return e?d(t,e):e}function R(e,t,n){return e?void 0!==n?(null===n?e.removeAttribute("data-"+t):e.setAttribute("data-"+t,n),n):e.getAttribute("data-"+t):null}function I(e){for(var t=0;null!=(e=D(e));)t++;return t}function N(e,t){do{e=P(e)}while(e&&!V(e,t));return e}function H(e,t,n){for(var a=null;null===a&&e;)(e=-1===n?D(e):T(e))&&V(e,t)&&(a=e);return a}function V(e,t){return!(!(e=i(e))||e===document)&&(e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}).call(e,t)}function U(e){return V(e,":hover")}function z(e,t){var n=i(e);if(t=i(t),!e||!t)return!1;for(;n=n.parentNode;)if(n===t)return!0;return!1}function Y(){var e=browser.msie6?i("PageContainer"):document.body,t=document.documentElement;return[e.scrollLeft||t.scrollLeft||window.pageXOffset||0,e.scrollTop||t.scrollTop||window.pageYOffset||0,t.clientWidth||e.clientWidth||0,t.clientHeight||e.clientHeight||0]}function W(e,t){for(var n=(t=t||{}).fromEl||P(e),r=t.positions||["relative","absolute","fixed"];n&&n!==bodyNode;){var i=ve(n,"position");if(Object(a.inArray)(i,r)&&(!t.noOverflow||"hidden"!==ve(n,"overflow")))break;n=P(n)}return n}function K(e,t){for(var n=e=i(e),a=void 0,r=void 0,o=void 0,s=!1;n&&n.tagName&&n!==bodyNode;){if(a=ve(n,"position"),r=ve(n,"overflow"),o=ve(n,"transform"),t&&browser.mozilla){if("page_wrap"!=n.id&&n!==e&&"visible"!==r&&("static"===a?!s||"relative"===s:"fixed"!==s))break}else if(n!==e&&"visible"!==r&&("static"===a?!s||"relative"===s:"fixed"!==s))break;"none"!==o?s=void 0:"static"!==a&&"fixed"!==s&&(s=a),n=P(n)}return n}function X(e){var t=arguments.length;if(t>1)for(var n=0;n<t;n++)X(arguments[n]);else if((e=i(e))&&e.style){var a=e.olddisplay,r=e.tagName.toLowerCase(),o="block";e.style.display=a||"","none"===ve(e,"display")&&(o=se(e,"inline")||se(e,"_inline")?"inline":se(e,"_inline_block")?"inline-block":"tr"!==r||browser.msie?"table"!==r||browser.msie?"block":"table":"table-row",e.style.display=e.olddisplay=o)}}function G(e){var t=arguments.length;if(t>1)for(var n=0;n<t;n++)G(arguments[n]);else if((e=i(e))&&e.style){var a=ve(e,"display");e.olddisplay="none"!==a?a:"",e.style.display="none"}}function $(e){return!(!(e=i(e))||!e.style)&&"none"!==ve(e,"display")}function Z(){return window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight}function Q(e,t,n){e=i(e),n=n||0;var r=ne(e)[1],o=re(e)[1],s=window,c=document.documentElement,d=Math.max(Object(a.intval)(s.innerHeight),Object(a.intval)(c.clientHeight)),u=i("page_header_cont"),p=c.scrollTop||bodyNode.scrollTop||window.scrollY||0,l=vk.staticheader?Math.max(0,re(u)[1]-p):re(u)[1];if(t){if(r+o<p+l+n)return r+o-p-l-n;if(r>p+d-n)return r-p-d+n}else{if(r<p+l+n)return r-p-l-n;if(r+o>p+d-n)return r+o-p-d+n}return 0}function J(e,t){return void 0===t&&(t=!$(e)),t?X(e):G(e),t}function ee(e){return void 0!==e.getBoundingClientRect}function te(e,t){var n=void 0;if(t&&"inline"===ve(e,"display")){var a=e.getClientRects();n=a&&a[0]||e.getBoundingClientRect()}else n=e.getBoundingClientRect();return n}function ne(e,t){if(!(e=i(e)))return[0,0];var n=e.ownerDocument,a={top:0,left:0};if(!n)return[0,0];var r=n.documentElement;ee(e)&&(a=te(e,!0));var o=n===n.window?n:9===n.nodeType&&(n.defaultView||n.parentWindow);return[a.left+(t?0:o.pageXOffset||r.scrollLeft)-(r.clientLeft||0),a.top+(t?0:o.pageYOffset||r.scrollTop)-(r.clientTop||0)]}function ae(e){return null!=e&&e===e.window}function re(e,t,n){e=i(e);var r=document.documentElement,o=[0,0],s=void 0;if(t&&"border-box"===ve(e,"boxSizing")&&(t=!1),e===document)o=[Math.max(r.clientWidth,bodyNode.scrollWidth,r.scrollWidth,bodyNode.offsetWidth,r.offsetWidth),Math.max(r.clientHeight,bodyNode.scrollHeight,r.scrollHeight,bodyNode.offsetHeight,r.offsetHeight)];else if(e){var c=function(){o=ee(e)&&(s=te(e,n))&&void 0!==s.width?[s.width,s.height]:[e.offsetWidth,e.offsetHeight],t&&Object(a.each)(o,function(t,n){var r=t?["Top","Bottom"]:["Left","Right"];Object(a.each)(r,function(){o[t]-=parseFloat(ve(e,"padding"+this))||0,o[t]-=parseFloat(ve(e,"border"+this+"Width"))||0})})};if($(e))c();else{var d={position:"absolute",visibility:"hidden",display:"block"},u={},p=!1;e.style.cssText.indexOf("!important")>-1&&(p=e.style.cssText),Object(a.each)(d,function(t,n){u[t]=e.style[t],e.style[t]=n}),c(),Object(a.each)(d,function(t,n){e.style[t]=u[t]}),p&&(e.style.cssText=p)}}return o}function ie(e){return re(e)[0]}function oe(e){return re(e)[1]}function se(e,t){var n=i(e);return n&&1===n.nodeType&&(" "+n.className+" ").replace(window.whitespaceRegex," ").indexOf(" "+t+" ")>=0}function ce(e,t){var n=i(e);n&&!se(n,t)&&(n.className=(n.className?n.className+" ":"")+t)}window.whitespaceRegex=/[\t\r\n\f]/g;var de=function(e,t){return setTimeout(ce.pbind(e,t),0)};function ue(e,t){var n=i(e);n&&(n.className=Object(a.trim)((n.className||"").replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ")))}var pe=function(e,t){return setTimeout(ue.pbind(e,t),0)};function le(e,t,n){return void 0===n&&(n=!se(e,t)),(n?ce:ue)(e,t),n}function _e(e,t,n){return void 0===n&&(n=!se(e,t)),(n?de:pe)(e,t),n}function fe(e,t,n){ue(e,t),ce(e,n)}function ve(e,t,n){if(e=i(e),Object(a.isArray)(t)){var r={};return Object(a.each)(t,function(t,n){return r[n]=ve(e,n)}),r}if(!e)return"";if(void 0===n&&(n=!0),!n&&"opacity"===t&&browser.msie){var o=e.style.filter;return o?o.indexOf("opacity=")>=0?parseFloat(o.match(/opacity=([^)]*)/)[1])/100+"":"1":""}if(!n&&e.style&&(e.style[t]||"height"===t))return e.style[t];var s=void 0,c=document.defaultView||window;if(c.getComputedStyle){t=t.replace(/([A-Z])/g,"-$1").toLowerCase();var d=c.getComputedStyle(e,null);d&&(s=d.getPropertyValue(t))}else if(e.currentStyle){if("opacity"===t&&browser.msie){var u=e.currentStyle.filter;return u&&u.indexOf("opacity=")>=0?parseFloat(u.match(/opacity=([^)]*)/)[1])/100+"":"1"}var p=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()});"auto"===(s=e.currentStyle[t]||e.currentStyle[p])&&(s=0),s=(s+"").split(" "),Object(a.each)(s,function(t,n){if(!/^\d+(px)?$/i.test(n)&&/^\d/.test(n)){var a=e.style,r=a.left,i=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,a.left=n||0,s[t]=a.pixelLeft+"px",a.left=r,e.runtimeStyle.left=i}}),s=s.join(" ")}if(n&&("width"===t||"height"===t)){var l=re(e,!0)[{width:0,height:1}[t]];s=(Object(a.intval)(s)?Math.max(Object(a.floatval)(s),l):l)+"px"}return s}function ge(e,t,n){if(e=i(e))if(Object(a.isObject)(t))Object(a.each)(t,function(t,n){return ge(e,t,n)});else if("opacity"===t)browser.msie&&((n+"").length?e.style.filter=1!==n?"alpha(opacity="+100*n+")":"":e.style.cssText=e.style.cssText.replace(/filter\s*:[^;]*/gi,""),e.style.zoom=1),e.style.opacity!==n&&(e.style.opacity=n);else try{var r="number"==typeof n;r&&/height|width/i.test(t)&&(n=Math.abs(n)),n=r&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t)?n+"px":n,e.style[t]!==n&&(e.style[t]=n)}catch(e){debugLog("setStyle error: ",[t,n],e)}}window.cssTransformProp=function(){var e=document.createElement("div");if(null==e.style.transform){var t=["Webkit","Moz","ms"];for(var n in t)if(void 0!==e.style[t[n]+"Transform"])return t[n]+"Transform"}return"transform"}();var he=function(e,t,n){return setTimeout(ge.pbind(e,t,n),0)};function me(e,t,n){var r=we(e,"pseudo-id");r||(we(e,"pseudo-id",r=Object(a.irand)(1e8,999999999)),ce(e,"_pseudo_"+r));var o=t+"-style-"+r,s=i(o),c="._pseudo_"+r+":"+t+"{";s||(s=headNode.appendChild(g("style",{id:o,type:"text/css"}))),Object(a.each)(n,function(e,t){c+=e+": "+t+" !important;"}),c+="}",s.sheet?(s.sheet.cssRules.length&&s.sheet.deleteRule(0),s.sheet.insertRule(c,0)):s.styleSheet&&(s.styleSheet.cssText=c)}function we(e,t,n){if(!e)return!1;var a=e[vkExpand];return a||(a=e[vkExpand]=++vkUUID),void 0!==n&&(vkCache[a]||(vkCache[a]={},window.__debugMode&&(vkCache[a].__elem=e)),vkCache[a][t]=n),t?vkCache[a]&&vkCache[a][t]:a}function ye(e,t,n){return e=i(e),void 0===n?e.getAttribute(t):(e.setAttribute(t,n),n)}function be(e){for(var t=0,n=arguments.length;t<n;++t){var a=arguments[t];if(void 0!==e[a])try{delete e[a]}catch(t){try{e.removeAttribute(a)}catch(e){}}}}function Ce(e,t){var n=!!e&&e[vkExpand];if(n)if(t){if(vkCache[n]){delete vkCache[n][t],t="";var a=0;for(var i in vkCache[n])if("__elem"!==i){a++;break}a||Ce(e)}}else Object(r.removeEvent)(e),be(e,vkExpand),delete vkCache[n]}function Ae(){for(var e=arguments,t=0;t<e.length;++t){var n=i(e[t]);n&&(Ce(n),be(n,"btnevents"))}}function xe(e,t,n){if((e=i(e))&&!e.titleSet){if(t||(t=e),t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)e.setAttribute("title",n||e.innerText||e.textContent);else{var a=s("b",e);a&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight)?e.setAttribute("title",n||e.innerText||e.textContent):e.removeAttribute("title")}e.titleSet=1}}function Ee(){var e=i("zoom_test_1")||document.body.appendChild(g("div",{id:"zoom_test_1"},{left:"10%",position:"absolute",visibility:"hidden"}));return(i("zoom_test_2")||document.body.appendChild(g("div",{id:"zoom_test_2"},{left:e.offsetLeft+"px",position:"absolute",visibility:"hidden"}))).offsetLeft/e.offsetLeft}function ke(e,t,n){if(e=i(e))return void 0!==t&&(e.setValue?(e.setValue(t),!n&&e.phonblur&&e.phonblur()):"INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.value=t:void 0!==e.emojiId&&window.Emoji?Emoji.val(e,t):e.innerHTML=t,!n&&Object(r.triggerEvent)(e,"valueChanged")),e.getValue?e.getValue():("INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.value:e.innerHTML)||""}function Se(e,t,n){e=i(e);try{if(e.focus(),void 0!==t&&!1!==t||(t=e.value.length),void 0!==n&&!1!==n||(n=t),e.setSelectionRange)e.setSelectionRange(t,n);else if(window.getSelection&&document.createRange){var a=document.createRange();a.selectNodeContents(e),a.collapse(!1);var r=window.getSelection();r.removeAllRanges(),r.addRange(a)}}catch(e){}}function Be(e,t,n){for(e=i(e),n=n||999;e&&!t(e);){if(0===--n)return!1;try{if((e=P(e))===document)break}catch(t){e=!1}}return e}var Te=!1;function De(e){if(!Te)return window.document.title=Object(a.replaceEntities)(e)}function je(e){Te=e,e&&window.cur&&window.cur.destroy.push(function(){je(!1)})}function Oe(){window.vkExpand=window.vkExpand||"VK"+Object(a.vkNow)(),window.vkUUID=window.vkUUID||0,window.vkCache=window.vkCache||{}}window.ge=i,window.geByTag=o,window.geByTag1=s,window.geByClass=c,window.geByClass1=d,window.gpeByClass=u,window.domQuery=p,window.domQuery1=l,window.domClosest=_,window.ce=g,window.cf=b,window.re=C,window.se=A,window.sech=x,window.rs=E,window.psr=k,window.domReplaceEl=S,window.domEL=B,window.domNS=T,window.domPS=D,window.domFC=j,window.domLC=O,window.domPN=P,window.domChildren=F,window.domInsertBefore=L,window.domInsertAfter=q,window.domByClass=M,window.domData=R,window.domChildIndex=I,window.domCA=N,window.domClosestSibling=H,window.matchesSelector=V,window.isHover=U,window.isAncestor=z,window.getScroll=Y,window.domClosestPositioned=W,window.domClosestOverflowHidden=K,window.show=X,window.hide=G,window.isVisible=$,window.clientHeight=Z,window.getClientRectOffsetY=Q,window.toggle=J,window.boundingRectEnabled=ee,window.getXYRect=te,window.getXY=ne,window.isWindow=ae,window.getSize=re,window.hasClass=se,window.addClass=ce,window.addClassDelayed=de,window.removeClass=ue,window.removeClassDelayed=pe,window.toggleClass=le,window.toggleClassDelayed=_e,window.replaceClass=fe,window.getStyle=ve,window.setStyle=ge,window.setStyleDelayed=he,window.setPseudoStyle=me,window.data=we,window.attr=ye,window.removeAttr=be,window.removeData=Ce,window.cleanElems=Ae,window.setTitle=xe,window.getZoom=Ee,window.val=ke,window.elfocus=Se,window.traverseParent=Be,window.getH=oe,window.getW=ie,window.domClosestByTag=f,window.setDocumentTitle=De,window.lockDocumentTitle=je},401:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _lib_dom_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(316),AppsEdit={PANORAMIC_SLIDER_MAX_PHOTOS:5,init:function(){cur.module="apps_edit",cur.nav.push(function(e,t,n){if(void 0===e[0]&&e.section)return this.switchSection(n.section),!1}.bind(this)),this.initPage()},initPage:function(){window.Dev&&window.Dev.checkBlockHeight()},switchTab:function(e,t,n){if(!n&&checkEvent(t))return!0;if(!n&&nav.objLoc.section==e)return!1;var a=ge("apps_nav_"+e);if(a){var r=geByClass("nav_selected",ge("dev_navigation"));for(var i in r)r.hasOwnProperty(i)&&removeClass(r[i],"nav_selected");addClass(a,"nav_selected");var o=ge("dev_left_nav");if(o&&r[0]){var s=ge("dev_left_nav_mark");setStyle(s,{height:getSize(r[0])[1],top:r[0].offsetTop||0}),addClass(o,"anim"),animate(s,{height:getSize(a)[1],top:a.offsetTop},{duration:100,onComplete:function(){removeClass(o,"anim")}})}}return!n&&(nav.go(a,t),!1)},animSubTab:function(e){var t=ge("app_edit_subheader"),n=t&&geByClass1("app_header_sel",t);if(t&&n){var a=ge("app_edit_nav_mark"),r=n&&n.offsetLeft||0,i=e.offsetLeft||0,o=i!=r?intval(70*Math.log(Math.abs(i-r)/20)):0;setStyle(a,{width:getSize(n)[0],left:r}),addClass(t,"anim"),removeClass(n,"app_header_sel"),addClass(e,"app_header_sel"),animate(a,{width:getSize(e)[0],left:i},{duration:o,transition:Fx.Transitions.easeOutCirc,onComplete:function(){removeClass(t,"anim"),setStyle(a,{display:""})}})}},switchSubTab:function(e,t){return this.animSubTab(e),nav.go(e,t)},switchSection:function switchSection(section){ajax.post("editapp",{section:section,id:cur.aid,load:1},{onDone:function onDone(content,script){hide("apps_edit_progress"),ge("app_edit_wrap").innerHTML=content,script&&eval(script),AppsEdit.hideError(),nav.setLoc(extend(nav.objLoc,{section:section})),AppsEdit.initPage(),scrollToTop(0)},onFail:AppsEdit.showError})},showError:function(e,t){if(!e)return!0;hide("apps_edit_progress");var n=void 0;return t?(n=ge(t),show(n)):(n=ge("app_edit_error"),show(ge("app_edit_error_wrap")),scrollToTop(200)),cur.errorShown=!0,n.innerHTML=e,!0},hideError:function(){cur.errorShown&&(hide("app_edit_error_wrap"),cur.errorShown=!1)},showRulesBox:function(e){return!showBox("editapp",{act:"show_rules",accept:e},{cache:1,params:{width:"650px",dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},onDone:AppsEdit.hideError,onFail:AppsEdit.showError,stat:["wk.css"]})},paramsData:function(e){var t={},n=function(e){return 0==e.indexOf("app_")?e.substr(4):e},a=geByTag("input",e);for(var r in a)if(a.hasOwnProperty(r)){var i=a[r];i.id&&(t[n(i.id)]=val(i))}var o=geByTag("textarea",e);for(var s in o)if(o.hasOwnProperty(s)){var c=o[s];c.id&&c.value&&(t[n(c.id)]=val(c))}var d=geByClass("checkbox",e);for(var u in d)if(d.hasOwnProperty(u)){var p=d[u];p.id&&(t[n(p.id)]=isChecked(p)?1:0)}for(var l in window.radioBtns)window.radioBtns.hasOwnProperty(l)&&(t[n(l)]=window.radioBtns[l].val);for(var _ in cur.dropDowns)cur.dropDowns.hasOwnProperty(_)&&(t[n(_)]=cur.dropDowns[_].val());return delete t.selectedItems,t},getParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||ge("app_edit_cont");return AppsEdit.paramsData(t)},generateServiceToken:function(e,t){ajax.post("al_apps_edit.php",{act:"generate_token",id:e,hash:t},{onDone:function(e){ge("service_token").value=e.service_token,ge("service_token_hash").value=e.service_token_hash},onFail:function(e){return AppsEdit.showError(e)}})},generateSecretKey:function(e,t,n){ajax.post("al_apps_edit.php",{act:"generate_secret_key",id:e,hash:t},{onDone:function(e){ge("app_secret2").value=e.secret_key,ge("secret_key_hash").value=e.secret_key_hash,ge("service_token").value=e.service_token,ge("service_token_hash").value=e.service_token_hash},onFail:function(e){return AppsEdit.showError(e)}})},showTooltipForField:function(e,t,n){var a=getSize(t);showTooltip(e,{text:n,dir:"left",width:.75*a[0],shift:[1.5*-a[1],.45*-a[1]]})},showMobileFrameTooltip:function(e){return AppsEdit.urlFocus(e,null,{noSetUrl:!0,noForceDown:!0,cls:"apps_mobile_iframe_secure_tt",slideX:0}),!1},showMobileAppleDevTeamIdTooltip:function(e){return AppsEdit.showHintTooltip(e,null,{noSetUrl:!0,noForceDown:!0,cls:"apps_mobile_iframe_secure_tt",slideX:0}),!1},saveOptions:function(e,t){var n=this.getParams("app_edit_cont");if(n.act=e||"save_options",n.help=Privacy.getValue("help"),"save_info"!=e){n.openapi=Privacy.getValue("openapi"),n.need_install=Privacy.getValue("install"),cur.privacy.push&&(n.push=Privacy.getValue("push"));var a=Privacy.getValue("require");if((a=a.split("_"))[1])for(var r in a=a[1].split(",")){if(a.hasOwnProperty(r))n["access_"+cur.maskByGroupNum[parseInt(a[r])-300]]=1}}t&&(n.confirm=1),lockButton(ge("app_save_btn"));AppsEdit.saveOptionsRequest(e,n,function(){unlockButton(ge("app_save_btn"))})},saveOptionsRequest:function(e,t,n){ajax.post("editapp",t,{onDone:function(t,a,r){if(n(),hide("apps_options_saved"),ge("apps_edit_error_text")&&hide("apps_edit_error_text"),AppsEdit.hideError(),"confirm"==t)showFastBox(a,r,getLang("global_continue"),function(){curBox().hide(),AppsEdit.saveOptions(e,!0)},getLang("global_cancel"));else if("error"==t)if("domain"==r){var i=ge("apps_addr_table");setStyle(i,"backgroundColor","#FAEAEA"),setTimeout(animate.pbind(i,{backgroundColor:"#FFFFFF"},300),400),elfocus("app_domain");var o=ge("apps_addr_result");o.innerHTML=a,fadeIn(o,200),scrollToTop(200)}else if("base_domain"==r)notaBene(cur.selectDD.control.firstChild),cur.selectDD.focusInput();else{var s=ge("app_"+r);elfocus(s),setStyle(s,"backgroundColor","#FAEAEA"),setTimeout(animate.pbind(s,{backgroundColor:"#FFFFFF"},300),400)}else{if(r.domain){var c=ge("app_domain");c&&(c.value=r.domain),hide("apps_addr_result")}r.titleNotice&&(ge("app_name_notice").innerHTML=r.titleNotice,show("app_name_notice"),r.titleHide?(addClass("app_name","apps_edit_input_readonly"),ge("app_name").readOnly=!0):(removeClass("app_name","apps_edit_input_readonly"),ge("app_name").readOnly=!1)),void 0!==r.canChangeGroup&&cur.dropDowns.app_group&&cur.dropDowns.app_group.disable(!r.canChangeGroup);var d=ge("apps_options_saved");d.innerHTML=a,show(d),scrollToTop(200)}},onFail:function(e){return n(),hide("apps_options_saved"),AppsEdit.showError(e)}})},saveVkAppOptions:function(e,t){var n=ge("app_edit_wrap"),a=this.getParams(ge("app_edit_wrap"));if(a.act=e||"save_options",a.help=Privacy.getValue("help"),"save_info"!=e){a.openapi=Privacy.getValue("openapi"),a.need_install=Privacy.getValue("install"),cur.privacy.push&&(a.push=Privacy.getValue("push"));var r=Privacy.getValue("require");if((r=r.split("_"))[1])for(var i in r=r[1].split(",")){if(r.hasOwnProperty(i))a["access_"+cur.maskByGroupNum[parseInt(r[i])-300]]=1}}t&&(a.confirm=1);var o=Array.prototype.slice.call(n.querySelectorAll("#app_save_btn"));for(var s in o)o[s]&&lockButton(o[s]);AppsEdit.saveOptionsRequest(e,a,function(){for(var e in o)o[e]&&unlockButton(o[e])})},saveAdsOptions:function(e,t){var n={act:"save_ads_web_settings",app_id:e,hash:t};n.ads_web_fb_interval=val("app_ads_web_fb_interval");var a=ge("app_ads_save_btn");lockButton(a);var r=function(){unlockButton(a)};function i(e){ge("apps_ads_settings_error").innerHTML=e,show("apps_ads_settings_error_wrap"),scrollToY(getXY(ge("apps_edit_ads_web_settings"))[1],200)}hide("apps_ads_settings_error_wrap"),hide("apps_ads_settings_save_info"),ajax.post("editapp",n,{onDone:function(e){if(r(),e.ok)e.message&&(n=e.message,(a=ge("apps_ads_settings_save_info")).innerHTML=n,show(a),scrollToY(getXY(ge("apps_edit_ads_web_settings"))[1],200));else{if(e.field){var t=ge("app_"+e.field+"_wrap")||ge("app_"+e.field);elfocus(t),setStyle(t,"backgroundColor","#FAEAEA"),setTimeout(animate.pbind(t,{backgroundColor:"#FFFFFF"},300),400)}e.error&&i(e.error)}var n,a},onFail:function(e){r(),i(e)}})},onAppAdsWebFBIntervalSliderChange:function(e){ge("apps_edit_ads_web_fb_interval_slider_selected_val").innerHTML=e},loadCheckHistory:function(e,t){if(isVisible("apps_check_history"))hide("apps_check_history");else{if(t){if(actionsMenuItemLocked(t))return;lockActionsMenuItem(t)}ajax.post("apps_check.php",{act:"a_check_history",no_version:1,app_id:e},{onDone:function(e){unlockActionsMenuItem(t),val("apps_check_history",e),show("apps_check_history")}})}},setMultilang:function(e,t,n,a){if(a){if(actionsMenuItemLocked(a))return;lockActionsMenuItem(a)}ajax.post("apps_check",{act:"switch_multilang",aid:e,enabled:t,hash:n},{onDone:function(){nav.reload()}})},resetNameCounter:function(e,t){ajax.post("apps_check",{act:"a_reset_counters",aid:e,hash:t},{onDone:function(){nav.reload()}})},appWidgetAccess:function(e,t,n,a){actionsMenuItemLocked(e)||(lockActionsMenuItem(e),ajax.post("apps_check",{act:"a_app_widget_access",aid:t,val:a,hash:n},{onDone:function(){nav.reload()},onFail:unlockActionsMenuItem.pbind(e)}))},adminApp:function(e,t,n,a,r,i,o,s,c,d){var u=showFastBox(cur.appEditAdminTitle,'<div id="apps_show_penalty" style="display:none;"><div style="color:#666;padding:5px 0;">'+cur.appEditAdminPenalty+'</div><input type="text" id="apps_penalty" class="text" style="width:440px" value="'+r+'"/></div><div style="color:#666;padding:5px 0;">'+cur.appEditAdminComment+'</div><textarea id="apps_check_comment" class="dark box_textarea"></textarea>'+(o||"")+(s||"")+(c||""));u.setOptions({width:500}),r>0?show("apps_show_penalty"):hide("apps_show_penalty"),u.removeButtons(),u.addButton(a,function(){if(!cur.adminActStarted){cur.adminActStarted=!0;var a={act:e,id:t,hash:n,penalty:ge("apps_penalty").value,comment:ge("apps_check_comment").value};o&&(a.ban_domain=isChecked("admin_app_bandomain")),s&&(a.warn_users=isChecked("admin_app_warnusers")),c&&(a[d]=isChecked("admin_custom_field")),ajax.post(i?"apps_check":"apps_check.php",a,{onDone:function(){nav.reload()},showProgress:u.showProgress,hideProgress:u.hideProgress})}},"yes"),u.addButton(getLang("box_cancel"),u.hide,"no")},adminTogglePlatform:function(e,t,n,a){if(a){if(actionsMenuItemLocked(a))return;lockActionsMenuItem(a)}var r={act:"a_toggle_platform_enabled",app_id:e,platform:t,hash:n};ajax.post("apps_check",r,{onDone:function(e){unlockActionsMenuItem(a),val(a,e)}})},uploadIcon:function(){showBox("editapp",{act:"upload_icon_box",aid:cur.aid},{params:{width:"430px",bodyStyle:"padding: 0px; position: relative;",dark:1}})},uploadPhoto:function(e){showBox("editapp",{act:"upload_photo_box",aid:cur.aid,big:e?1:0,edit_lang:cur.editLang},{params:{width:"438px",bodyStyle:"padding: 0px; position: relative;",dark:1}})},checkAddress:function(e){cur.addrUnchecked=0,clearTimeout(cur.addressCheckTO),cur.lastAddress!=val("app_domain")&&(cur.addressCheckTO=setTimeout(AppsEdit.doCheckAddress,e||0))},doCheckAddress:function(){var e=ge("apps_addr_result");fadeOut(e,200),cur.lastAddress=val("app_domain"),hide("apps_addr_result"),ajax.post("editapp",{act:"a_check_address",name:cur.lastAddress,aid:cur.aid},{onDone:function(t){cur.addrChecked=1,e.innerHTML=t,fadeIn(e,200)},onFail:function(t){return cur.addrChecked=-1,e.innerHTML=t,fadeIn(e,200),!0}})},deleteApp:function(){showBox("editapp",{act:"delete_app_box",aid:cur.aid},{params:{dark:1,width:"430px",bodyStyle:"padding: 20px; line-height: 160%;"}})},activateRow:function(e){var t=geByClass("apps_edit_delete_row",e);t[0].active||animate(t[0],{backgroundColor:"#C4D2E1"},200)},deactivateRow:function(e){var t=geByClass("apps_edit_delete_row",e);t[0].active||animate(t[0],{backgroundColor:"#FFF"},200)},activateDelete:function(e){e.active=!0,animate(e,{backgroundColor:"#6B8DB1"},200),showTooltip(e,{text:getLang("global_delete"),showdt:500})},deactivateDelete:function(e){e.active=!1,animate(e,{backgroundColor:"#C4D2E1"},200),window.tooltips&&tooltips.hide(e)},deleteSWF:function(e,t,n){tooltips.hide(n);var a=void 0;a=showFastBox(getLang("apps_title_file_delete"),getLang("apps_confirm_file_delete"),getLang("global_delete"),function(){a.showProgress(),ajax.post("editapp",{act:"a_delete_swf",aid:cur.aid,swf_id:e,hash:t},{onDone:function(t){a.hideProgress(),a.content(t),a.removeButtons(),a.addButton(getLang("global_close"),a.hide),setTimeout(a.hide,2e3),re("apps_edit_swf_"+e);var n=geByClass("apps_edit_swf_row",ge("apps_edit_flash_other_options"));1==n.length&&re(n[0])}})},getLang("global_cancel"),function(){a.hide()})},showHint:function(e,t,n){e=ge(e);var a=cur.hint[e.id];clearTimeout(cur.hideHintTimout),t?showTooltip(e,{text:a,slide:15,className:"apps_edit_up_tt",shift:[0,-1,0]}):showTooltip(e,{text:'<div class="apps_edit_side_tt_pointer"></div>'+a,slideX:15,className:"apps_edit_tt",shift:n||[-291,0,-60],forcetodown:!0})},hideHint:function(e){e=ge(e),clearTimeout(cur.hideHintTimout),cur.hideHintTimout=setTimeout(function(){window.tooltips&&e.tt&&e.tt.hasOwnProperty("hide")&&e.tt.hide()},500)},showSecret:function showSecret(aid,hash){ajax.post("al_apps_edit.php",{act:"a_show_secret",aid:aid,hash:hash},{onDone:function onDone(title,html,js){showFastBox(title,html),eval(js)},loader:1})},showSecretInPlace:function(e,t){ajax.post("al_apps_edit.php",{act:"a_show_secret_in_place",aid:e,hash:t},{onDone:function(e){ge("secret_key_edit").innerHTML=e},loader:1})},changeType:function(e,t,n,a){var r=ge("apps_check_change_type_label"),i=domPN(r);if(a){if(actionsMenuItemLocked(a))return;lockActionsMenuItem(a)}return ajax.post("apps_check",{act:"change_type",aid:e,hash:t,from:"appview",new_type:n},{onDone:function(e){uiActionsMenu.hide(i),unlockActionsMenuItem(a),val(r,e)}}),!1},getUploadErrorText:function(e,t,n){var a={apps_full_banner_error:"apps_full_banner_size_1120_error",apps_photo_error:"apps_photo_size_error",apps_catalog_image_error:"apps_catalog_image_size_278_error",apps_discover_image_error:"apps_discover_image_size_576_error",apps_screenshot_error:"apps_screenshot_size_error",apps_panoramic_banner_error:"apps_full_banner_size_1120_error"};return 105==e?n.apps_banner_size_error:-1==e?n[a[t]||n.apps_banner_size_error]:"ERR_UPLOAD_BAD_IMAGE_SIZE"==e&&"apps_panoramic_banner_error"==t?n[a[t]]:n.apps_photo_notloaded_unknown},initUpload:function initUpload(cont,opts,lang,resObj){var options={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",lang:lang,onUploadStart:function(e,t){"form"==Upload.types[e]&&window.box&&show(window.box.progress),hide("apps_edit_upload_error")},onNoFilteredCallback:function(){if(lang){var e=Upload.obj[0],t=domPN(e);hasClass(t,"apps_edit_progress")&&removeClass(t,"apps_edit_progress"),AppsEdit.showError(lang.apps_edit_invalid_image_file,opts.errorObj)}},onUploadComplete:function onUploadComplete(i,res){var obj=void 0;try{obj=eval("("+res+")")}catch(e){obj=q2ajx(res)}if(obj.code)Upload.onUploadError(i,obj.code);else if(obj.error)Upload.onUploadError(i,obj.error);else{opts.vars.mid&&(obj.mid=opts.vars.mid);var params={act:opts.save_act,app_id:cur.aid};cur.editLang&&(params.edit_lang=cur.editLang),"apps_banner_error"==opts.errorObj&&hide("apps_banner_update"),ajax.post("editapp",extend(obj,params),{onDone:function(e,t){opts.success_callback?cur[opts.success_callback](e,t):(resObj.src=e,addClass(resObj.parentNode,"apps_edit_img_loaded")),opts.lite||Upload.embed(i),opts.errorObj&&hide(opts.errorObj)},onFail:function(e){return AppsEdit.showError(e,opts.errorObj),opts.lite||Upload.embed(i),!0}})}},onUploadProgress:function(e,t,n){if(!ge("form"+e+"_progress")){var a=Upload.obj[e],r=getSize(a)[1]/2+10,i=a.firstChild;for(addClass(a.parentNode,"apps_edit_progress");i;)1==i.nodeType&&(i.id=="uploader"+e&&browser.msie?setStyle(i,{position:"relative",left:"-5000px"}):setStyle(i,{visibility:"hidden"})),i=i.nextSibling;a.appendChild(ce("div",{innerHTML:'<div class="apps_info_progress_wrap"><div id="form'+e+'_progress" class="apps_upload_progress" style="width: 0%;"></div></div></div>',className:"apps_info_prg_cont"},{height:r+"px",marginTop:-r+"px"}))}var o=intval(t/n*100);o=Math.min(o,100),setStyle(ge("form"+e+"_progress"),{width:o+"%"})},onUploadError:function(e,t){debugLog("error",e,t);var n=AppsEdit.getUploadErrorText(t,opts.errorObj,lang),a=void 0!==e.ind?e.ind:e,r=Upload.obj[a],i=domPN(r);hasClass(i,"apps_edit_progress")&&removeClass(i,"apps_edit_progress"),Upload.embed(a),AppsEdit.showError(n,opts.errorObj)},clear:1,type:"photo",buttonClass:"secondary small",max_attempts:3,server:opts.server,error:opts.default_error,error_hash:opts.error_hash,dropbox:"apps_icon_dropbox"};return opts.lite&&(options.flash_lite=1),Upload.init(cont,opts.url,opts.vars,options)},ssOver:function(e){var t=geByClass1("apps_edit_screen_close",e);t||(t=se('<div class="apps_edit_screen_close" onmouseover="showTooltip(this, {black: 1, text: \''+cur.remove_screenshot+"', shift: [12, 2, 0], forcetoup: 1});\"></div>"),addEvent(t,"click",AppsEdit.ssClose.pbind(e,t)),cur.destroy.push(function(){removeEvent(t,"click")}),e.appendChild(t)),fadeIn(t,100)},ssClose:function(e,t,n){var a=e.getAttribute("rel");return ajax.post("editapp",{act:"a_remove_screenshot",hash:cur.photoHash,aid:cur.aid,pid:a}),fadeOut(e,200,function(){re(e),cur.ssCount<cur.ssMax&&show("apps_edit_upload_screenshot")}),cur.ssCount-=1,cur.ssCount<cur.ssMax&&hide("apps_edit_ss_reason"),t.tt&&t.tt.destroy(),cancelEvent(n)},ssOut:function(e){var t=geByClass1("apps_edit_screen_close",e);fadeOut(t,100)},ssClick:function(e){var t=e.getAttribute("rel");showBox("editapp",{act:"show_screen",aid:cur.aid,pid:t},{dark:1})},removeFullBanner:function(e,t){hide("apps_edit_full_wrap"),geByTag1("img",geByClass1("selected",ge("apps_edit_full_wrap"))).src=isRetina()?"/images/dquestion_v.png":"/images/dquestion_u.png",removeClass(e,"apps_edit_progress"),Upload.embed(t),ajax.post("editapp",{act:"a_clear_full_banner",hash:cur.photoHash,aid:cur.aid,format:1,edit_lang:cur.editLang})},certUploadBox:function(e,t){var n=(Privacy.getValue("push")||"").split("_");showBox("editapp",{act:"select_cert",aid:cur.aid,push:n[2],cert_type:t},{params:{dark:1,bodyStyle:"padding: 20px; line-height: 160%;"}})},urlFocus:function(e,t,n){n=n||{},val(e)||n.noSetUrl||val(e,"http://"),AppsEdit.showHintTooltip(e,t,n)},showHintTooltip:function(e,t,n){n=n||{},t=t?cur[t]:domData(e,"hint");var a=!n.noforceDown,r=void 0!==n.slideX?n.slideX:15,i=n.shift||[-291,0,-60],o=n.cls||"apps_edit_tt";t&&showTooltip(e,{text:'<div class="apps_edit_side_tt_pointer"></div>'+t,className:o,slideX:r,forcetodown:a,shift:i,hasover:1,onCreate:function(){removeEvent(e,"mouseout"),addEvent(e,"blur",AppsEdit.urlBlur.pbind(e))}})},urlBlur:function(e){"http://"==val(e)&&val(this,""),e.tt&&e.tt.hide()},addToNew:function(e,t){showBox("editapp",{act:"add_to_new_box",aid:e,hash:t},{dark:!0})},enableOrders:function(e,t,n){var a=ge("enable_orders_btn");AppsEdit.hideError(),ajax.post("editapp",{act:"enable_orders",aid:e,force:n,hash:t},{onDone:function(n,a){if(n)ge("apps_new_api_notice").innerHTML=a;else var r=showFastBox(getLang("global_action_confirmation"),a,getLang("box_yes"),function(){r.hide(),AppsEdit.enableOrders(e,t,1)},getLang("global_cancel"))},onFail:function(e){return showFastBox(getLang("global_error"),e),!0},showProgress:function(){lockButton(a)},hideProgress:function(){unlockButton(a)}})},checkSize:function(e,t){var n=val(e);n>t?(notaBene(e),val(e,t)):n!=positive(n)&&(notaBene(e),val(e,positive(n)||607))},updateSecureUrl:function(){if(!cur.iframeSecureChanged){var e=val("app_iframe_url").replace(/^http:/,"https:").trim();val("app_m_iframe_secure_url",e)}},onChangeIFrameUrl:function(){var e=val("app_iframe_url");e&&(/^http:\/\//.test(e)?val("app_iframe_url",e.replace(/^http:/,"https:")):/^https:\/\//.test(e)?val("app_iframe_url")!==e&&val("app_iframe_url","https://"+e):val("app_iframe_url","https://"+e))},onChangeDevUrl:function(){var e=val("vk_app_dev_url").trim();e&&val("vk_app_dev_url")!==e&&val("vk_app_dev_url",e)},onChangeDesktopDevUrl:function(){var e=val("vk_app_desktop_dev_url").trim();e&&val("vk_app_desktop_dev_url")!==e&&val("vk_app_desktop_dev_url",e)},onChangeMobileSecureUrl:function(){var e=val("app_m_iframe_secure_url").trim(),t=ge("apps_edit_m_apple_dev_team_id");e?(/^http:\/\//.test(e)?val("app_m_iframe_secure_url",e.replace(/^http:/,"https:")):/^https:\/\//.test(e)?val("app_m_iframe_secure_url")!==e&&val("app_m_iframe_secure_url",e):val("app_m_iframe_secure_url","https://"+e),AppsEdit.slideShow(t)):AppsEdit.slideHide(t)},onKeyUpMobileSecureUrl:function(){var e=val("app_m_iframe_secure_url").trim(),t=ge("apps_edit_m_apple_dev_team_id");e?AppsEdit.slideShow(t):AppsEdit.slideHide(t)},addFunc:function(){hide("apps_edit_funcs_empty"),hide("apps_edit_funcs_not_found"),show("func_search_panel");for(var e=ge("apps_edit_funcs"),t=void 0;inArray(t=Math.floor(1e7*Math.random(),cur.funcIds)););cur.funcIds.unshift(t),cur.funcInfos[t]={name:"",code:'return "Hello World";'};var n=se(rs(cur.funcRowTpl,{name:"newFunc",code:'return "Hello World";',id:t}));addClass(geByClass1("apps_edit_cont_row",n),"apps_edit_new_func"),e.insertBefore(n,e.firstChild),cur.funcsVersions[t]={last_v:1,versions:[[-1,-1]]};var a=ge("func_row_"+t);addClass(a,"dev_func_loaded"),addClass(a,"dev_no_func_versions"),AppsEdit.switchEditFunc(t),geByClass1("apps_edit_cont_name",n).focus(),AppsEdit.updateFuncsSort()},removeFunc:function(e){var t=ge("func_row_"+e);delete cur.funcInfos[e];var n=indexOf(cur.funcIds,e);cur.funcIds.splice(n,1);var a=geByClass1("apps_edit_editor",t);if(a&&a.ace&&a.ace.destroy(),re(t.parentNode),0==cur.funcIds.length)show("apps_edit_funcs_empty"),hide("func_search_panel");else{var r=!1;for(var i in cur.funcIds)if(cur.funcIds.hasOwnProperty(i)){var o=cur.funcIds[i],s=ge("func_row_"+o);isVisible(s)&&(r=!0)}if(!r){var c=val(ge("func_search")),d=ge("apps_edit_funcs_not_found"),u=getLang("developers_no_funcs_found").split("{query}").join("<b>"+this.cleanStr(c)+"</b>");d.innerHTML=u,show(d)}}delete cur.funcsVersion[e],delete cur.funcsVersions[e],delete cur.funcsVersionsDD[e],delete cur.editedFuncs[e]},removeFuncVersion:function(e,t){for(var n=cur.funcsVersions[e].versions,a=-1,r=0;r<n.length;r++)if(n[r][0]==t){a=n[r+1][0];var i=n.slice(r+1);cur.funcsVersions[e].versions=n.slice(0,r).concat(i);break}AppsEdit.updateVersionsDD(e),AppsEdit.putVersionCode(e,a),cur.funcsVersions[e].disable_add==t&&(show("apps_edit_add_version"+e),delete cur.funcsVersions[e].disable_add),cur.funcsVersions[e].last_v==t&&cur.funcsVersions[e].last_v--,cur.funcsVersions[e].versions.length<=1&&addClass("func_row_"+e,"dev_no_func_versions"),delete cur.editedFuncs[e]},removeFuncBox:function(e){if(!cur.funcSaving){var t=ge("func_row_"+e),n=val(geByClass1("apps_edit_cont_name",t));n="execute."+n;var a=cur.funcsVersion[e],r=void 0;r=a>0?cur.lang.developers_func_remove_confirm.replace("{v}",a).replace("{name}",clean(n)):cur.lang.developers_remove_func_confrim.replace("%s",clean(n));var i=showFastBox({title:cur.lang.developers_remove_func,dark:1},r,cur.lang.developers_do_remove,function(){cur.funcSaving=!0;var t=cur.funcInfos[e],n={act:"save_func",aid:cur.aid,hash:cur.funcsHash,old_name:t.name};cur.funcsVersion[e]>0&&(n.act="a_remove_func_version",n.v=a,AppsEdit.removeFuncVersion(e,a)),ajax.post("editapp",n,{onDone:function(t,n,r){a>0||AppsEdit.removeFunc(e),cur.funcSaving=!1},onFail:function(e,t){cur.funcSaving=!1}}),i.hide()},getLang("global_cancel"))}},initVersionDropdown:function(e){cur.verDD||(cur.verDD={}),ge("apps_edit_const_v_"+e).value=cur.lastVersion,cur.verDD[e]=new Dropdown(ge("apps_edit_const_v_"+e),cur.versions,{width:118,big:1,selectedItem:cur.lastVersion})},saveFunc:function(e,t,n){if(!cur.funcSaving){cur.funcSaving=!0,e&&lockButton(e);var a=cur.funcInfos[t],r=ge("func_row_"+t),i=geByClass1("apps_edit_cont_name",r),o=geByClass1("apps_edit_editor",r);if(!o||!o.ace)return unlockButton(e),void(cur.funcSaving=!1);var s=o.ace.getValue(),c=val(i),d={act:"save_func",aid:cur.aid,hash:cur.funcsHash,name:c,code:s,old_name:a.name};if(cur.funcsVersion[t]>0){d.act="a_save_func_version",d.func=a.name,d.v=cur.funcsVersion[t];for(var u=cur.funcsVersions[t].versions,p=0;p<u.length;p++)if(u[p][0]==cur.funcsVersion[t]){cur.funcsVersions[t].versions[p][1]=s;break}}else cur.funcInfos[t].code=s;ajax.post("editapp",d,{onDone:function(n,u){if("name"==n)notaBene(i);else if("code"==n){var p=geByClass1("apps_edit_err_info",r);p.innerHTML=u,isVisible(p.parentNode)||slideDown(p.parentNode,150),o.ace.focus()}else if("limit"==n)showFastBox({title:cur.lang.box_error,dark:1},u);else{d.v&&-1!=d.v?d.v==cur.funcsVersions[t].disable_add&&(delete cur.funcsVersions[t].disable_add,show("apps_edit_add_version"+t)):(a.name=c,a.code=s);var l=geByClass("apps_edit_err_info_cont",r);for(var _ in l)isVisible(l[_])&&slideUp(l[_],150);var f=geByClass1("apps_edit_cancel_button",r);fadeOut(f,150,function(){var e=geByClass1("apps_edit_save_info",r);e.innerHTML=n,fadeIn(e,150),setTimeout(function(){fadeOut(e,150,function(){fadeIn(f,150)})},2e3)}),removeClass(r,"apps_edit_new_func"),cur.needSaveSort[t]&&(r=r.parentNode,delete cur.needSaveSort[t],AppsEdit.saveFuncsPosition(r,!1,r.previousSibling))}e&&unlockButton(e),delete cur.editedFuncs[t],cur.funcSaving=!1,cur.funcsSaveCallbacks[t]&&(cur.funcsSaveCallbacks[t](),delete cur.funcsSaveCallbacks[t])},onFail:function(t,n,a){e&&(unlockButton(e),cur.funcSaving=!1)},loader:!!n})}},cancelFuncChange:function(e){if(!cur.funcSaving){var t=ge("func_row_"+e),n=val(geByClass1("apps_edit_cont_name",t)),a=geByClass1("apps_edit_editor",t),r="";a&&a.ace&&(r=a.ace.getValue());var i=cur.funcInfos[e];if(i.name||i.code!=r)if(n==i.name&&i.code==r||cur.funcsVersion[e]>0)AppsEdit.switchEditFunc(e);else var o=showFastBox({title:cur.lang.developers_cancel_func,dark:1},cur.lang.developers_cancel_func_confrim.replace("%s",clean(n)),cur.lang.developers_do_cancel,function(){i.name?(a&&a.ace&&(a.ace.setValue(i.code.replace(/\_\!\_/g,"<!>"),1),a.ace.focus()),geByClass1("apps_edit_cont_name",t).value=i.name?i.name:"newFunc"):AppsEdit.removeFunc(e);o.hide()});else AppsEdit.removeFunc(e)}},runFunc:function(e,t){if(!isButtonLocked(t)){var n=ge("func_row_"+e),a=geByClass1("apps_edit_editor",n),r="";if(a&&a.ace&&(r=a.ace.getValue()),cur.runContProgress)return!1;for(var i={act:"a_run_method",method:"execute",param_code:r,hash:cur.runHash,aid:cur.aid},o=AppsEdit.getExecuteFields(n),s=geByClass1("apps_edit_params",n),c=0;c<o.length;c++){var d=o[c],u=geByClass1("execute_param_"+d,s),p=geByClass1("execute_field_input",u);i["param_"+d]=val(p)}cur.verDD[e]&&(i.param_v=cur.verDD[e].val()),ajax.post("dev",i,{onDone:function(e){var t=parseJSON(e),n=window.Dev.wrapObject(t,!0);showFastBox({title:cur.lang.developers_run_result,dark:1,width:500,bodyStyle:"padding: 16px 16px 16px 2px;"},'<div id="dev_result" onmousemove="Dev.resultMove(event.target);" onmouseout="Dev.resultMove(false);">'+n+"</div>")},onFail:function(e){return e='<pre style="white-space:normal;word-wrap:break-word;">'+clean(e.replace(/^<pre>|<\/pre>$/g,""))+"</pre>",setTimeout(showFastBox(getLang("global_error"),e).hide,2e3),!0},showProgress:function(){lockButton(t)},hideProgress:function(){unlockButton(t)},stat:["dev.js","dev.css"]})}},adjustHeight:function(e,t){for(var n=e.renderer.lineHeight<=1?16:e.renderer.lineHeight,a=e.getSession().getScreenLength()*n+e.renderer.scrollBar.width,r=domPN(t);!hasClass(r,"apps_edit_cont_row");)r=domPN(r);var i=geByClass1("apps_edit_run_wrap",r);a=Math.max(122,a,getSize(i)[1]+26),setStyle(domPN(t),{height:a}),e.resize()},initEditor:function(e,t){var n=window.ace.edit(e);e.ace=n,n.on("change",function(){AppsEdit.updateExecuteParams(n,e),cur.editedFuncs[t]=1});var a=n.getSession();a.setMode("ace/mode/javascript"),a.setUseWorker(!1),this.adjustHeight(n,e),a.on("tokenizerUpdate",function(){AppsEdit.updateExecuteParams(n,e)})},getExecuteFields:function(e){for(var t=geByClass1("apps_edit_params",e).childNodes,n=[],a=0;a<t.length;a++){if(t[a].className){var r=t[a].className.match(/(?:\\s|^)execute_param_(.+)(?:\\s|$)/);r&&r[1]&&n.push(r[1])}}return n},updateExecuteParams:function(e,t){for(var n=domPN(t);!hasClass(n,"apps_edit_cont_row");)n=domPN(n);var a=AppsEdit.getExecuteFields(n);e.session.getLength();for(var r=new(0,window.ace.require("ace/token_iterator").TokenIterator)(e.getSession(),0,0),i=[],o=[],s=-100,c=-100,d=-1,u=void 0;u=r.stepForward();)if(d++,"identifier"==u.type&&"Args"==u.value&&(s=d),"punctuation.operator"==u.type&&"."==u.value&&(c=d),"identifier"==u.type&&s==d-2&&c==d-1){var p=u.value;i.indexOf(p)<0&&(i.push(p),a.indexOf(p)<0&&o.push(p))}for(var l=[],_=0;_<a.length;_++){var f=a[_];i.indexOf(f)<0&&l.push(f)}if(1==o.length&&1==l.length){var v=l[0],g=o[0],h=geByClass1("execute_param_"+v,n);removeClass(h,"execute_param_"+v),addClass(h,"execute_param_"+g),geByClass1("execute_field_name",h).innerHTML=g}else{for(var m=geByClass1("apps_edit_params",n),w=0;w<l.length;w++){var y=l[w],b=geByClass1("execute_param_"+y,m);m.removeChild(b)}for(var C=0;C<o.length;C++){var A=o[C],x=ce("div",{className:"execute_param_"+A,innerHTML:"<div class='execute_field_name'>"+A+"</div><input class='text execute_field_input' type='text'>"});m.appendChild(x)}}this.adjustHeight(e,t)},closeEditFunc:function(){if(cur.currentFunc){hide("apps_edit_add_version"+cur.currentFunc);var e=ge("func_row_"+cur.currentFunc);if(e){removeClass(e,"active");var t=geByClass1("apps_edit_cont_name",e);setTimeout(function(){t.readOnly=!0},0);var n=geByClass1("apps_edit_content",e);slideUp(n,150,function(){AppsEdit.updateFuncsSort()})}}},onDestroyFuncs:function(e,t,n,a){if(cur.leaving)return delete cur.leaving,void delete cur.editedFuncs;var r=[];for(var i in cur.editedFuncs)cur.editedFuncs[i]&&r.push(cur.funcInfos[i].name);if(0==r.length)return!0;cur.dev_prev_sec=nav.objLoc.section,AppsEdit.switchTab("functions",{},1);var o=cur.lang.developers_func_nosaved_confirm.replace("%s",r.join(", ")),s=showFastBox({title:getLang("global_warning"),dark:1},o,getLang("global_continue"),function(){cur.leaving=!0,s.hide(),cur.onContinueCb&&cur.onContinueCb()},getLang("global_cancel"),function(){s.hide(),cur.onCancelCb&&cur.onCancelCb()});return cur.onContinueCb=function(){nav.go(n),"editapp"==n[0]&&AppsEdit.switchTab(n.section,{},1)},!1},initFuncsSort:function(){cur.sorter&&cur.sorter.destroy(),setTimeout(function(){cur.qsorterNoOperaStyle=!0,cur.qsorterRowClass="apps_edit_sortable_row clear_fix ",cur.qsorterRowUpClass="apps_edit_sortable_row apps_edit_sortable_row_up",cur.sorter=window.qsorter.init(ge("apps_edit_funcs"),{width:665,height:62,xsize:1,dragEls:geByClass("apps_edit_sortable_row",ge("apps_edit_funcs")),canDrag:function(e){return!(cur.disableSort||hasClass(geByClass("apps_edit_cont_row",e)[0],"active")||cur.currentFunc)},onReorder:AppsEdit.saveFuncsPosition,noMoveCursor:1})},100)},updateFuncsSort:function(){var e=ge("apps_edit_funcs");window.qsorter.update(e,{dragEls:geByClass("apps_edit_sortable_row",e)})},switchEditFunc:function(e,t){if(t){var n=t.target;for(cancelEvent(t);n;){if(hasClass(n,"apps_edit_ver_dd"))return;n=n.parentNode}}if(!cur.funcDDShown||e!=cur.funcDDShown){if(AppsEdit.closeEditFunc(),cur.initedFunctions[e]||(AppsEdit.initEditor(geByClass("apps_edit_editor",ge("func_row_"+e))[0],e),AppsEdit.initVersionDropdown(e),cur.initedFunctions[e]=1,AppsEdit.loadFuncVersions(e),cur.funcsVersionsDD[e]=new Dropdown(ge("funcs_versions_dd"+e),[],{width:200,big:1,autocomplete:!0,multiselect:!1,placeholder:cur.lang.developers_search_version,onChange:function(t){t&&AppsEdit.checkSaveFuncs(e,t)},onBlur:function(){setTimeout(function(){cur.funcDDShown=!1},500)}})),cur.currentFunc==e)return cur.currentFunc=null,void(cur.disableSort||removeClass("apps_edit_funcs","apps_edit_no_sortable"));addClass("apps_edit_funcs","apps_edit_no_sortable"),cur.funcsVersions[e]&&!cur.funcsVersions[e].disable_add&&show("apps_edit_add_version"+e),cur.currentFunc=e;var a=ge("func_row_"+e);addClass(a,"active"),geByClass1("apps_edit_cont_name",a).readOnly=!1;var r=geByClass1("apps_edit_content",a);slideDown(r,150,function(){var t=geByClass1("apps_edit_editor",ge("func_row_"+e));t&&t.ace&&(AppsEdit.adjustHeight(t.ace,t),AppsEdit.updateExecuteParams(t.ace,t))})}},checkSaveFuncs:function(e,t){if(cur.editedFuncs[e])var n=new MessageBox({title:getLang("global_warning"),dark:1}).content(cur.lang.developers_confirmation_sh_func).addButton(getLang("box_yes"),function(){cur.funcsSaveCallbacks[e]=function(){delete cur.editedFuncs[e],AppsEdit.putVersionCode(e,t)},AppsEdit.saveFunc(!1,e,1),n.hide()}).addButton(getLang("box_no"),function(){AppsEdit.putVersionCode(e,t),n.hide()},"gray").show();else AppsEdit.putVersionCode(e,t)},loadFuncVersions:function(e){if(!cur.funcsVersions[e]){var t=cur.funcInfos[e];ajax.post("al_apps_edit.php",{act:"a_get_func_versions",func:t.name,aid:cur.aid},{onDone:function(t){t||(t={last_v:1,versions:[[-1,-1]]}),cur.funcsVersions[e]={last_v:t.last_v,versions:t.versions},AppsEdit.updateVersionsDD(e),cur.funcsVersionsDD[e].val(-1);var n=ge("func_row_"+e);addClass(n,"dev_func_loaded"),t.versions.length<=1?addClass(n,"dev_no_func_versions"):show("apps_edit_add_version"+e)}})}},addFuncVersion:function(e,t){if(!(!t&&cur.funcsSaveCallbacks[e]||cur.funcsVersions[e].disable_add))if(cur.editedFuncs[e])var n=function(t){a.hide(),hasClass(t,"secondary")?(delete cur.editedFuncs[e],AppsEdit.addFuncVersion(e,1)):(cur.funcsSaveCallbacks[e]=function(){delete cur.editedFuncs[e],AppsEdit.addFuncVersion(e,1)},AppsEdit.saveFunc(!1,e,1))},a=new MessageBox({title:getLang("global_warning"),dark:1}).content(cur.lang.developers_confirmation_sh_func).addButton(getLang("box_yes"),n).addButton(getLang("box_no"),n,"gray").show();else{cur.funcsVersions[e].last_v++;var r=cur.funcsVersions[e].last_v,i=AppsEdit.getFuncVersionCode(e,cur.funcsVersions[e].versions[0][0]);cur.funcsVersions[e].versions.unshift([r,i]),AppsEdit.updateVersionsDD(e),AppsEdit.putVersionCode(e,r),removeClass("func_row_"+e,"dev_no_func_versions"),hide("apps_edit_add_version"+e),cur.funcsVersions[e].disable_add=r}},saveFuncsPosition:function(){var e=[],t=arguments;if(hasClass(geByClass1("apps_edit_cont_row",t[0]),"apps_edit_new_func")){var n=parseInt(t[0].id.replace("func_sort",""));cur.needSaveSort[n]=!0}else{t[2]&&1==t[2].nodeType&&hasClass(geByClass1("apps_edit_cont_row",t[2]),"apps_edit_new_func")&&(t[2]=t[2].previousSibling);var a=void 0;for(var r in t)t.hasOwnProperty(r)&&(a=t[r]&&1==t[r].nodeType?geByClass1("apps_edit_cont_name",t[r]).value:null,e.push(a));ajax.post("al_apps_edit.php",{act:"a_resort_funcs",aid:cur.aid,list:e.join(",")},{onDone:function(){}})}},showVersionsDD:function(e){show("apps_edit_ver_dd"+e),cur.funcsVersionsDD[e].focus(),cur.funcDDShown=e,cur.funcsVersions[e]&&!cur.funcsVersions[e].disable_add&&show("apps_edit_add_version"+e)},updateVersionsDD:function(e){for(var t=cur.funcsVersions[e].versions,n=[],a=0;a<t.length;a++)n.push([t[a][0],cur.lang.developers_version_pref+" "+Math.abs(t[a][0])]);cur.funcsVersionsDD[e].select.clear(),cur.funcsVersionsDD[e].setData(n)},getFuncVersionCode:function(e,t){var n=void 0;if(-1==t)n=cur.funcInfos[e].code.replace(/\_\!\_/g,"<!>");else for(var a=cur.funcsVersions[e].versions,r=0;r<a.length;r++)if(a[r][0]==t){n=a[r][1];break}return n},putVersionCode:function(e,t){var n=AppsEdit.getFuncVersionCode(e,t);ge("func_remove_btn"+e).innerHTML=-1==t?cur.lang.developers_func_remove:cur.lang.developers_remove_func_version,cur.funcsVersion[e]=parseInt(t),geByClass("apps_edit_editor",ge("func_row_"+e))[0].ace.setValue(n),delete cur.editedFuncs[e],delete cur.funcsSaveCallbacks[e],cur.funcsVersionsDD[e].val(t)},switchEditActivity:function(e,t){if(void 0===t&&(t=150),cur.currentActivity){var n=ge("activity_row_"+cur.currentActivity);if(n){removeClass(n,"active");var a=geByClass1("apps_edit_content",n);slideUp(a,t)}}if(cur.currentActivity!=e){cur.currentActivity=e;var r=ge("activity_row_"+e);addClass(r,"active");var i=geByClass1("apps_edit_content",r);slideDown(i,t,function(){var t=geByClass1("apps_edit_editor",ge("func_row_"+e));t&&t.ace&&AppsEdit.adjustHeight(t.ace,t)})}else cur.currentActivity=null},switchEditRequest:function(e,t){if(void 0===t&&(t=150),cur.currentRequest){var n=ge("request_row_"+cur.currentRequest);if(n){removeClass(n,"active");var a=geByClass1("apps_edit_cont_name",n);setTimeout(function(){a.readOnly=!0},0);var r=geByClass1("apps_edit_content",n);slideUp(r,t)}}if(cur.currentRequest!=e){cur.currentRequest=e;var i=ge("request_row_"+e);addClass(i,"active");var o=geByClass1("apps_edit_cont_name",i);o&&(o.readOnly=!1);var s=geByClass1("apps_edit_content",i);slideDown(s,t,function(){var t=geByClass1("apps_edit_editor",ge("func_row_"+e));t&&t.ace&&AppsEdit.adjustHeight(t.ace,t)})}else cur.currentRequest=null},collectRequestData:function(e){return ge("request_row_"+e)?{name:trim(val("request_name_"+e)),text_m:trim(val("request_text_m_"+e)),text_f:trim(val("request_text_f_"+e)),text_mul:trim(val("request_text_mul_"+e)),button:trim(val("request_accept_text_"+e)),response:!!isChecked("request_response_"+e)}:{}},collectActivityData:function(e){return ge("activity_row_"+e)?{name:trim(val("activity_text_name_"+e)),text_m:trim(val("activity_text_m_"+e)),text_f:trim(val("activity_text_f_"+e)),points:parseInt(trim(val("activity_text_points_"+e)))}:{}},checkActivityFields:function(e){var t=this.collectActivityData(e);return t.name?t.text_m?t.text_f?t.points?(t.response=t.response?1:0,t):(notaBene(domPN(ge("activity_text_points_"+e))),elfocus("activity_text_mul_"+e),!1):(notaBene(domPN(ge("activity_text_f_"+e))),elfocus("activity_text_f_"+e),!1):(notaBene(domPN(ge("activity_text_m_"+e))),elfocus("activity_text_m_"+e),!1):(notaBene("activity_name_"+e),t.name&&this.showRequestMsg(ge("activity_row_"+e),!0,getLang("apps_wrong_activity_name")),!1)},checkRequestFields:function(e){var t=this.collectRequestData(e);return t.name.match(/^([a-zA-Z0-9_]+)$/)?t.text_m?t.text_f?t.text_mul?t.button?(t.response=t.response?1:0,t):(notaBene("request_accept_text_"+e),!1):(notaBene(domPN(ge("request_text_mul_"+e))),elfocus("request_text_mul_"+e),!1):(notaBene(domPN(ge("request_text_f_"+e))),elfocus("request_text_f_"+e),!1):(notaBene(domPN(ge("request_text_m_"+e))),elfocus("request_text_m_"+e),!1):(notaBene("request_name_"+e),t.name&&this.showRequestMsg(ge("request_row_"+e),!0,getLang("apps_wrong_request_name")),!1)},requestNotModified:function(e){var t=cur.requests[e]||this.defaultRequestData(),n=this.collectRequestData(e);for(var a in n)if(n.hasOwnProperty(a)&&t[a]!==n[a])return!1;return!0},activityNotModified:function(e){if(cur.activityChanged=cur.activityChanged||{},!cur.activities[e]&&!cur.activityChanged[e])return!0;var t=cur.activities[e],n=this.collectActivityData(e);if(!t)return!1;for(var a in n)if(n.hasOwnProperty(a)&&t[a]!==n[a])return!1;return!0},defaultRequestData:function(){return{name:"newRequest",text_m:getLang("apps_sent_request_m"),text_f:getLang("apps_sent_request_f"),text_mul:getLang("apps_sent_request_mul"),button:getLang("apps_request_button_accept"),response:!1}},defaultActivityData:function(){var e=unclean(cur.activitySamples).split("<#>");return{name:(e=e[Math.floor(Math.random()*e.length)].split("<!>"))[0],text_m:e[1],text_f:e[2],points:10}},updateRemainingPoints:function(){var e=0;each(geByClass("apps_edit_activity_points"),function(){e+=parseInt(val(this))||0});var t=Math.max(cur.maxTotalPoints-e,0),n=langNumeric(t,cur.lang.apps_activities_edit_points_remain);return each(geByClass("apps_edit_points_remain_text"),function(){this.innerHTML=n}),cur.activityRemainPoints=t,cur.maxTotalPoints-e},toggleRequestsBtn:function(){toggle("add_requests_btn",geByClass("apps_edit_cont_row",ge("apps_edit_requests")).length<cur.maxRequests)},toggleActivitiesBtn:function(){toggle("add_activities_btn",geByClass("apps_edit_cont_row",ge("apps_edit_activities")).length<cur.maxActivities)},requestInsertRow:function(e,t){if(e&&t){var n=geByClass("apps_edit_cont_row",t),a=parseInt(e.id.replace("request_row_","")),r=!1;for(var i in n){if(n.hasOwnProperty(i))if(parseInt(n[i].id.replace("request_row_",""))<a){r=n[i];break}}r?t.insertBefore(e,r):t.appendChild(e)}},activityInsertRow:function(e,t){if(e&&t){var n=geByClass("apps_edit_cont_row",t),a=parseInt(e.id.replace("activity_row_","")),r=!1;for(var i in n){if(n.hasOwnProperty(i))if(parseInt(n[i].id.replace("activity_row_",""))<a){r=n[i];break}}r?t.insertBefore(e,r):t.appendChild(e)}},onActivityInputsChange:function(e,t){var n=gpeByClass("apps_edit_cont_row",e);if(n){var a=n.getAttribute("data-id");a>2e9&&(cur.activityChanged=cur.activityChanged||{},cur.activityChanged[a]=!0);var r=geByClass1("apps_edit_activity_name",n),i=geByClass1("apps_edit_activity_points",n),o=geByClass1("apps_edit_activity_title_name",n),s=geByClass1("apps_edit_activity_title_points",n),c=parseInt(val(i))||0;(c>cur.maxPointsPerActivity||c<0)&&val(i,Math.max(0,Math.min(cur.maxPointsPerActivity,c))),clearTimeout(cur._activityInputChangeTO),cur._activityInputChangeTO=setTimeout(function(){o.innerHTML=clean(trim(r.value)||getLang("apps_activities_unnamed")),s.innerHTML=clean(langNumeric(trim(i.value)||0,cur.lang.apps_edit_activities_points)||"")},50)}},addActivity:function(){hide("apps_edit_activity_empty"),hide("apps_edit_activity_not_found"),cur.activityId=(cur.activityId||2e9)+1;var e=ge("apps_edit_activities_new"),t=cur.activityId,n=this.rowFromActivity(t,this.defaultActivityData());AppsEdit.requestInsertRow(n,e),show(e),AppsEdit.toggleRequestsBtn(),AppsEdit.switchEditRequest(t),AppsEdit.updateRemainingPoints(),geByClass1("apps_edit_activity_name",n).select(),re(geByClass1("apps_edit_activity_delete_btn",n))},addRequest:function(){hide("apps_edit_requests_empty"),hide("apps_edit_requests_not_found"),cur.requestId=(cur.requestId||2e9)+1;var e=ge("apps_edit_requests_new"),t=cur.requestId,n=this.rowFromRequest(t,this.defaultRequestData());AppsEdit.requestInsertRow(n,e),show(e),AppsEdit.toggleRequestsBtn(),AppsEdit.switchEditRequest(t),geByClass1("apps_edit_cont_name",n).focus()},showRequestMsg:function(e,t,n){var a=geByClass1("apps_edit_cancel_button",e);return fadeOut(a,150,function(){var r=geByClass1("apps_edit_save_info",e);t&&(n='<span class="save_error">'+n+"</span>"),r.innerHTML=n,fadeIn(r,150),setTimeout(function(){fadeOut(r,150,fadeIn.pbind(a,150))},2e3)}),!0},showRequestUserTT:function(e,t){var n=getLang(t||"apps_edit_request_user_name");showTooltip(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+n,className:"apps_edit_tt user",slide:15,shift:[1,9,9]})},showActivityUserTT:function(e,t,n){var a=getLang(t||"apps_edit_request_user_name");showTooltip(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+a,className:"apps_edit_tt user",slide:15,shift:n||[1,9,9]})},showRequestStatusTT:function(e,t){var n=getLang("apps_edit_request_created"),a=cur.requests[t];if(a){switch(a.status){case 0:n=getLang("apps_edit_request_created");break;case 1:n=getLang("apps_edit_request_accepted");break;case 2:n=getLang("apps_edit_request_declined")}window.tooltips&&tooltips.hideAll(),showTooltip(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+n,className:"apps_edit_tt user",slide:15,shift:[17,15,15]})}},showActivityStatusTT:function(e,t){var n=getLang("apps_edit_activity_created"),a=cur.activities[t];if(a){switch(a.status){case 0:n=getLang("apps_edit_activity_created");break;case 1:n=getLang("apps_edit_activity_accepted");break;case 2:n=getLang("apps_edit_activity_declined")}window.tooltips&&tooltips.hideAll(),showTooltip(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+n,className:"apps_edit_tt user apps_edit_tt_left",slide:15,forcetoleft:!0,shift:[207,15,15]})}},rowFromRequest:function(e,t){var n="";switch(t.status){case 0:n="review";break;case 1:n="accepted";break;case 2:n="declined"}var a={id:e,row_class:n,name:t.name,text_m:t.text_m,text_f:t.text_f,text_mul:t.text_mul,button:t.button,check_class:t.response?" on":"",disabled_attr:1==t.status?' disabled="disabled"':"",disabled_class:1==t.status?" disabled":""};return se(rs(cur.requestRowTpl,a))},rowFromActivity:function(e,t,n){var a="";switch(t.status){case 0:a="review";break;case 1:a="accepted";break;case 2:a="declined"}var r={id:e,row_class:a,name:t.name,text_m:t.text_m,text_f:t.text_f,points:t.points,points_text:langNumeric(t.points,cur.lang.apps_edit_activities_points),check_class:t.response?" on":"",disabled_attr:1==t.status?' disabled="disabled"':"",disabled_class:1==t.status?" disabled":"",id_hide_style:n?"":"display: none",points_label_hide_style:n?"":"display: none",disabled_points_attr:1==t.status?" ":"",disabled_points_class:1==t.status?" ":""};return se(rs(cur.activityRowTpl,r))},saveActivity:function(e,t){var n=this.checkActivityFields(t);if(n&&!cur.activitySaving){cur.activitySaving=!0,e&&lockButton(e);var a=ge("activity_row_"+t),r=extend({act:"save_activity",aid:cur.aid,hash:cur.activityHash,activity_id:t},n);ajax.post("editapp",r,{onDone:function(e,n,r){var i=cur.activities[e],o=AppsEdit.activityRowsCnt();cur.activities[e]=n;var s=AppsEdit.rowFromActivity(e,n,!0),c=domPN(a),d=ge("apps_edit_activities_status"+n.status);c.id==d.id&&i&&i.status==n.status?c.replaceChild(s,a):(AppsEdit.removeActivity(t,!0),AppsEdit.activityInsertRow(s,d),show(d)),cur.currentActivity=null,t==e?AppsEdit.switchEditActivity(e,0):1==o&&AppsEdit.showActivityStatusTT(geByClass1("apps_edit_cont_icon",s),e),AppsEdit.showRequestMsg(s,!1,r),AppsEdit.updateRemainingPoints()},onFail:AppsEdit.showRequestMsg.pbind(a,!0),hideProgress:function(){e&&(unlockButton(e),cur.activitySaving=!1)}})}},toggleActivity:function(e,t){var n=gpeByClass("apps_edit_cont_row",e),a=geByClass1("apps_edit_content",n);toggle(a)},saveRequest:function(e,t){var n=this.checkRequestFields(t);if(n&&!cur.requestSaving){cur.requestSaving=!0,e&&lockButton(e);var a=ge("request_row_"+t),r=extend({act:"save_request",aid:cur.aid,hash:cur.requestHash,request_id:t},n);ajax.post("editapp",r,{onDone:function(e,n,r){var i=cur.requests[e],o=AppsEdit.requestRowsCnt();cur.requests[e]=n;var s=AppsEdit.rowFromRequest(e,n),c=domPN(a),d=ge("apps_edit_requests_status"+n.status);c.id==d.id&&i&&i.status==n.status?c.replaceChild(s,a):(AppsEdit.removeRequest(t,!0),AppsEdit.requestInsertRow(s,d),show(d)),cur.currentRequest=null,t==e?AppsEdit.switchEditRequest(e,0):1==o&&AppsEdit.showRequestStatusTT(geByClass1("apps_edit_cont_icon",s),e),AppsEdit.showRequestMsg(s,!1,r)},onFail:AppsEdit.showRequestMsg.pbind(a,!0),hideProgress:function(){e&&(unlockButton(e),cur.requestSaving=!1)}})}},correctActivityPointsInput:function(e){var t=parseInt(val(e))||0;val(e,t)},cancelActivityChange:function(e){if(!cur.activitySaving){var t=ge("activity_row_"+e),n=cur.activities[e],a=geByClass1("apps_edit_content",t),r=geByClass1("apps_edit_activity_title_name",t);if(AppsEdit.activityNotModified(e))n?toggle(a):AppsEdit.removeActivity(e);else var i=showFastBox({title:getLang("apps_cancel_activity"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},getLang("apps_cancel_activity_confrim"),getLang("developers_do_cancel"),function(){n?((ge("activity_text_m_"+e)||{}).value=unclean(n.text_m),(ge("activity_text_f_"+e)||{}).value=unclean(n.text_f),(ge("activity_text_name_"+e)||{}).value=unclean(n.name),val("activity_points_"+e,n.points),val(r,trim(n.name)||getLang("apps_activities_unnamed")),toggle(a)):AppsEdit.removeActivity(e),i.hide()})}},cancelRequestChange:function(e){if(!cur.requestSaving){var t=ge("request_row_"+e),n=val(geByClass1("apps_edit_cont_name",t)),a=cur.requests[e];if(AppsEdit.requestNotModified(e))a?AppsEdit.switchEditRequest(e):AppsEdit.removeRequest(e);else var r=showFastBox({title:getLang("apps_cancel_request"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},getLang("apps_cancel_request_confrim").replace("%s",clean(n)),getLang("developers_do_cancel"),function(){a?(val("request_name_"+e,a.name),val("request_text_m_"+e,a.text_m),val("request_text_f_"+e,a.text_f),val("request_text_mul_"+e,a.text_mul),val("request_accept_text_"+e,a.button),checkbox("request_response_"+e,a.response)):AppsEdit.removeRequest(e),r.hide()})}},activityRowsCnt:function(e){return e||(e=ge("apps_edit_activities")),(e&&geByClass("apps_edit_cont_row",e)||[]).length},requestRowsCnt:function(e){return e||(e=ge("apps_edit_requests")),(e&&geByClass("apps_edit_cont_row",e)||[]).length},removeRequest:function(e,t){var n=ge("request_row_"+e),a=domPN(n);re(n);var r=AppsEdit.requestRowsCnt(ge("apps_edit_requests"));AppsEdit.requestRowsCnt(a)||hide(a),t||(delete cur.requests[e],AppsEdit.toggleRequestsBtn(),r||show("apps_edit_requests_empty"))},removeActivity:function(e,t){var n=ge("activity_row_"+e),a=domPN(n);re(n);var r=AppsEdit.activityRowsCnt(ge("apps_edit_requests"));AppsEdit.activityRowsCnt(a)||hide(a),t||(delete cur.activities[e],AppsEdit.toggleActivitiesBtn(),r||show("apps_edit_activities_empty"))},removeActivityBox:function(e){if(cur.activitySaving)return!1;var t=cur.activities[e];if(!AppsEdit.activityNotModified(e)||t)var n=ge("activity_row_"+e),a=val(geByClass1("apps_edit_cont_name",n)),r=showFastBox({title:getLang("apps_remove_activity"),dark:1},getLang("apps_remove_activity_confirm").replace("%s",clean(a)),getLang("developers_do_remove"),function(){t?(cur.activitySaving=!0,ajax.post("editapp",{act:"delete_activity",aid:cur.aid,hash:cur.activityHash,activity_id:e},{onDone:AppsEdit.removeActivity.pbind(e,!1),onFail:AppsEdit.showRequestMsg.pbind(n,!0),hideProgress:function(){cur.activitySaving=!1}})):AppsEdit.removeActivity(e),r.hide()},getLang("global_cancel"));else AppsEdit.removeActivity(e)},removeRequestBox:function(e){if(cur.requestSaving)return!1;var t=cur.requests[e];if(!AppsEdit.requestNotModified(e)||t)var n=ge("request_row_"+e),a=val(geByClass1("apps_edit_cont_name",n)),r=showFastBox({title:getLang("apps_remove_request"),dark:1},getLang("apps_remove_request_confrim").replace("%s",clean(a)),getLang("developers_do_remove"),function(){t?(cur.requestSaving=!0,ajax.post("editapp",{act:"delete_request",aid:cur.aid,hash:cur.requestHash,request_id:e},{onDone:AppsEdit.removeRequest.pbind(e,!1),onFail:AppsEdit.showRequestMsg.pbind(n,!0),hideProgress:function(){cur.requestSaving=!1}})):AppsEdit.removeRequest(e),r.hide()},getLang("global_cancel"));else AppsEdit.removeRequest(e)},updateList:function(e,t){if(27==e.keyCode)return this.resetList(t);clearTimeout(cur.searchTimeout),setTimeout(function(){var e=trim(t.value);this.searchList(e)}.bind(this),10)},cleanStr:function(e){return e.replace(/([<>&#]*)/g,"")},resetList:function(e){return val(e,""),AppsEdit.searchList(!1)},searchList:function(e){e?(e=e.toLowerCase(),cur.disableSort=!0,addClass("apps_edit_funcs","apps_edit_no_sortable")):(delete cur.disableSort,removeClass("apps_edit_funcs","apps_edit_no_sortable")),toggle("apps_edit_reset_search",!!e);var t=ge("apps_edit_funcs_not_found"),n=getLang("developers_no_funcs_found"),a=ge("apps_edit_funcs"),r=geByClass("apps_edit_sortable_row",a),i=0;for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];if(e){var c=val(geByClass1("apps_edit_cont_name",s));(c=c.toLowerCase()).indexOf(e)>-1?(show(s),i++):hide(s)}else show(s),i++}if(e&&!i){var d=n.split("{query}").join("<b>"+this.cleanStr(e)+"</b>");t.innerHTML=d,show(t)}else hide(t)},uInit:function(e){AppsEdit.uInitScroll(),extend(cur,{opts:e,searchInp:ge("apps_edit_search_inp"),index:{},cache:{},lang:extend(cur.lang||{},e.lang)});for(var t=[],n=["Top","Bottom","Left","Right"],a=0;a<4;++a)t.push("padding"+n[a]);var r=extend({margin:0},getStyle(cur.searchInp,t));isFunction(window.placeholderSetup)&&window.placeholderSetup(cur.searchInp,{back:!0,pad:r,phColor:"#929eb0"}),elfocus(cur.searchInp),cur.destroy.push(function(e){e==cur&&AppsEdit.uDeinitScroll()}),AppsEdit.uIndex(cur.opts.data)},uInitScroll:function(){AppsEdit.scrollnode=browser.msie6?pageNode:window,AppsEdit.uDeinitScroll(),addEvent(AppsEdit.scrollnode,"scroll",AppsEdit.uScroll),addEvent(window,"resize",AppsEdit.uScroll)},uDeinitScroll:function(){removeEvent(AppsEdit.scrollnode,"scroll",AppsEdit.uScroll),removeEvent(window,"resize",AppsEdit.uScroll)},uScroll:function(){if(!browser.mobile){var e=document.documentElement,t=window.innerHeight||e.clientHeight||bodyNode.clientHeight,n=scrollGetY(),a=ge("apps_edit_users_more");isVisible(a)&&n+t>a.offsetTop&&a.onclick()}},uIndex:function(e,t){cur.opts.data=e,cur.cache={all:[]};for(var n=0,a=e.length;n<a;++n)cur.cache.all.push(n);cur.index=new vkIndexer(cur.cache.all,function(e){return cur.opts.data[e][2]},t?function(){}:AppsEdit.uSearchUpdate)},uResetSearch:function(){val(cur.searchInp,""),elfocus(cur.searchInp),AppsEdit.uSearchUpdate()},uSearch:function(){var e=trim(val(cur.searchInp));if(e.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/))return AppsEdit.uEditAdmin(AppsEdit.uGetAddr(e))},uGetAddr:function(e){var t=e.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/(.+)$/),n=t[4].substr(t[4].indexOf("#")+1).replace(/^[\/\!]*/,"");return(t=n.match(/^profile\.php\?id=(\d+)/))?n=intval(t[1]):(-1!==n.indexOf("?")&&(n=n.substr(0,n.indexOf("?"))),(t=n.match(/^id(\d+)/))&&(n=intval(t[1]))),n},uSearchUpdate:function(){if("apps_edit_search_inp"==(cur.searchInp||{}).id){var e=trim(val(cur.searchInp));toggle("apps_edit_reset_search",!!e),AppsEdit.uShowMore(!0)}},uAddUpdate:function uAddUpdate(el){var q=trim(val(el));if(!q.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/)||q===cur.lastUserQ)return!1;cur.lastUserQ=q;var addr=AppsEdit.uGetAddr(q);clearTimeout(cur.addAdminTO),cur.addAdminTO=setTimeout(function(){ajax.post("/al_apps_edit.php",{act:"edit_admin_box",id:cur.opts.aid,addr:addr},{showProgress:function(){el&&addClass(domPN(el),"loading")},hideProgress:function(){el&&removeClass(domPN(el),"loading")},onFail:function(e){var t=ge("apps_edit_user_info");return!!t&&(ge("apps_edit_add_user_error").innerHTML=e,show("apps_edit_add_user_error"),hide(t),curBox().setOptions({hideButtons:!0}),!0)},onDone:function onDone(title,html,js){var content=ge("apps_edit_user_info");if(!content)return!1;hide("apps_edit_add_user_error"),content.innerHTML=html,show(content),curBox(),js&&eval(js)}})},500)},uUpdateSummary:function(){!trim(val(cur.searchInp))&&isVisible("apps_edit_summary")&&(cur.opts.all_count>0?val("apps_edit_summary",cur.opts.all_count):hide("apps_edit_summary"))},uShowMore:function(e){var t=cur.opts.data,n=trim(val(cur.searchInp)),a=!1;if(t){var r=cur.cache.all;if(e){if(AppsEdit.uUpdateSummary(),cur.qShown===n)return;cur.qShown=n}if(n)if(n.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/)){var i=AppsEdit.uGetAddr(n);r=[];for(var o=0,s=t.length;o<s;++o)t[o][0]!=i&&t[o][1]!="/"+i||r.push(o)}else{if(void 0===(r=cur.cache["_"+n])){var c=cur.index.search(n),d={};r=[];for(var u=0,p=c.length;u<p;++u)d[c[u]]||(d[c[u]]=!0,r.push(c[u]));r.sort(function(e,t){return e-t}),cur.cache["_"+n]=r}a=AppsEdit.uGetHighlight(n)}var l=r.length,_=ge("apps_edit_users_rows"),f=ge("apps_edit_users_more");if(!l)return hide(f,"apps_edit_summary"),void val(_,AppsEdit.uGenEmpty(getLang("apps_no_admin_found")));for(var v=e?0:_.childNodes.length,g=Math.min(l,v+20),h=[],m=v;m<g;++m){var w=t[r[m]],y=(w||{})[2];w&&(a&&(y=y.replace(a.re,a.val)),h.push(AppsEdit.uGenRow(w,y)))}e?(val(_,h.join("")),show("apps_edit_summary"),n?val("apps_edit_summary",l):AppsEdit.uUpdateSummary()):_.innerHTML+=h.join(""),toggle(f,g<l)}},uGetHighlight:function(e){var t=cur.index,n=t.delimiter,a=t.trimmer;return e+=" "+(parseLatin(e)||""),e=(e=escapeRE(e).replace(/&/g,"&amp;")).replace(a,"").replace(n,"|"),{re:new RegExp("("+e+")","gi"),val:'<span class="apps_edit_user_highlight">$1</span>'}},uGenEmpty:function(e){return'<div class="apps_edit_users_none">'+e+"</div>"},uGenRow:function(e,t){var n=e[0],a=e[1],r=e[3],i=e[5],o=cur.opts.levels[i]||"",s="",c=t||e[2],d=cur.qShown;if(!t&&d&&!d.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/)){var u=AppsEdit.uGetHighlight(d);c=c.replace(u.re,u.val)}return cur.opts.main_admin&&cur.mainAdminChanging?4==i||5==i?s+="":3!=i?s+='<a class="apps_edit_user_action" onclick="AppsEdit.uChangeMainAdmin('+n+')">'+getLang("apps_main_admin_promote")+"</a>":s='<a class="apps_edit_user_action" onclick="AppsEdit.uMainAdmin(true)">'+getLang("apps_main_admin_change_cancel")+"</a>":0==i?s='<a class="apps_edit_user_action" onclick="AppsEdit.uEditAdmin('+n+')">'+getLang("apps_add_admin")+"</a>":3!=i?(s+='<a class="apps_edit_user_action" onclick="AppsEdit.uEditAdmin('+n+')">'+getLang("Edit")+"</a>",s+=' | <a class="apps_edit_user_action" onclick="AppsEdit.uRemoveAdmin('+n+')">'+getLang("apps_edit_admin_demote")+"</a>"):cur.opts.main_admin&&cur.opts.all_count>1&&(s='<a class="apps_edit_user_action" onclick="AppsEdit.uMainAdmin()">'+getLang("apps_main_admin_change")+"</a>"),rs(cur.opts.template,{oid:n,name:c,photo:r,href:a,level:o,actions:s})},uShowMessage:function(e){return showDoneBox(e),!0},uEditAdmin:function(e){showBox("al_apps_edit.php",{act:"edit_admin_box",id:cur.opts.aid,addr:e},{onFail:AppsEdit.uShowMessage,params:{width:490}})},uAddAdmin:function(){cur.lastUserQ="",showBox("al_apps_edit.php",{act:"add_admin_box",id:cur.opts.aid},{onFail:AppsEdit.uShowMessage,params:{hideButtons:!0,width:490}})},uRemoveAdmin:function(e){var t=curBox();return t&&t.hide(),showBox("al_apps_edit.php",{act:"edit_admin_box",id:cur.opts.aid,addr:e,remove:1},{onFail:AppsEdit.uShowMessage,params:{width:490}}),!1},uSelAdminLevel:function(e,t,n){radiobtn(e,t,n);var a=ge("apps_admin_partial_level_desc").innerHTML.replace(/^\s+|[\s:]+$/g,"");t?(hide("apps_edit_admin_rights"),val("apps_admin_partial_level_desc",a)):(show("apps_edit_admin_rights"),val("apps_admin_partial_level_desc",a+":"))},uSaveAdmin:function(e,t){var n={act:"save_admin",id:cur.opts.aid,mid:e,hash:t,level:radioval("admins_level"),rights:[]};each(geByClass("checkbox",ge("apps_edit_admin_rights")),function(e,t){isChecked(t)&&n.rights.push(t.getAttribute("id").replace(/^apps_admin_right_/,""))}),n.rights.length&&ajax.post("al_apps_edit.php",n,{onDone:function(t,n){if(curBox().hide(),t&&AppsEdit.uShowMessage(t),n){var a=cur.opts.data,r=!1;if(isArray(a))for(var i=0;i<a.length;++i)if(a[i][0]==e){r=!0,0==a[i][5]&&++cur.opts.all_count,cur.opts.data[i]=n;break}r?(delete cur.qShown,AppsEdit.uSearchUpdate()):(cur.opts.data.unshift(n),++cur.opts.all_count,val(cur.searchInp,""),delete cur.qShown,AppsEdit.uIndex(cur.opts.data)),AppsEdit.uUpdateSummary()}},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},uDoRemoveAdmin:function(e,t){var n={act:"delete_admin",id:cur.opts.aid,mid:e,hash:t};ajax.post("al_apps_edit.php",n,{onDone:function(t,n){if(curBox().hide(),t&&AppsEdit.uShowMessage(t),n){var a=cur.opts.data;if(isArray(a))for(var r=0;r<a.length;++r)if(a[r][0]==e){cur.opts.data[r]=n,--cur.opts.all_count,delete cur.qShown,AppsEdit.uSearchUpdate();break}}},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},uMainAdmin:function(e){if(e){if(!cur.mainAdminChanging)return;cur.mainAdminChanging=!1}else{if(cur.mainAdminChanging)return;cur.mainAdminChanging=!0}delete cur.qShown,AppsEdit.uSearchUpdate()},uChangeMainAdmin:function(e){if(cur.mainAdminChanging)return showBox("al_apps_edit.php",{act:"change_main_admin_box",id:cur.opts.aid,mid:e},{cache:1,onFail:function(e){return AppsEdit.uShowMessage(e),!0}}),!1},uDoChangeMainAdmin:function(e,t){var n={act:"change_main_admin",id:cur.opts.aid,mid:e,hash:t};ajax.post("al_apps_edit.php",n,{onDone:function(t,n){curBox().hide(),t&&AppsEdit.uShowMessage(t),cur.mainAdminChanging=!1,cur.opts.main_admin=n;var a=cur.opts.data;if(isArray(a)){for(var r=0;r=a.length;++r)a[r][0]==e?cur.opts.data[r][5]=3:3==cur.opts.data[r][5]&&(cur.opts.data[r][5]=2);delete cur.qShown,AppsEdit.uSearchUpdate()}},onFail:function(e){return curBox().hide(),AppsEdit.uShowMessage(e),!0},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},initFunctionsClone:function(e){e&&(this.funcsCloneChoser=new Dropdown(ge("apps_edit_clone_funcs_app_choser"),e,{width:230,big:1,multiselect:!1,noResult:""}))},cloneStoredFuncs:function(e){var t=ge("apps_edit_clone_button"),n=this,a=showFastBox({title:getLang("apps_clone_stored_funcs_confirm_title"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},getLang("apps_clone_stored_funcs_confirm_text"),getLang("apps_clone_stored_funcs_confirm_button"),function(){a.hide(),lockButton(t),ajax.post("al_apps_edit.php",{act:"clone_funcs",from_aid:cur.aid,to_aid:n.funcsCloneChoser.val(),hash:e},{onDone:function(){unlockButton(t)}})},"Close",function(){a.hide()})},loadStatApiData:function loadStatApiData(method,statInterval){if(cur.api_stat_interval==statInterval&&cur.api_stat_filter_method==method)return!1;ajax.post("editapp",{act:"stats_api_data",id:cur.aid,method:method,stat_interval:statInterval,hash:cur.statsApiHash},{cache:1,onDone:function onDone(content,script){if(ge("apps_edit_stats_api").innerHTML=content,cur.api_stat_interval=statInterval,cur.api_stat_filter_method=method,script&&eval(script),"2days"!=statInterval||""!=method){var newLocVars={};""!=method&&(newLocVars.method=method),"2days"!=statInterval&&(newLocVars.stat_interval=statInterval),nav.setLoc(extend(nav.objLoc,{method:method,stat_interval:statInterval}))}},onFail:AppsEdit.showError,showProgress:function(){cur.api_stat_interval=statInterval,removeClass(ge("api_interval_selector_2days"),"selected"),removeClass(ge("api_interval_selector_week"),"selected"),removeClass(ge("api_interval_selector_month"),"selected"),addClass(ge("api_interval_selector_"+cur.api_stat_interval),"selected"),show(ge("apps_edit_api_prg"))},hideProgress:function(){hide(ge("apps_edit_api_prg"))}})},changeStatBlockPeriod:function(e,t,n){var a,r,i;cur.statsMainBlockCurrentPeriodType=cur.statsMainBlockCurrentPeriodType||"day",hasClass(e,"selected")||(a=geByClass("app_stats_main_block_tab"),each(a,function(){removeClass(this,"selected")}),addClass(e,"selected"),i=geByClass("app_stat_retention"),each(i,function(){removeClass(this,"active")}),r=ge("app_stats_retention_"+t),addClass(r,"active"),cur.statsMainBlockCurrentPeriodType!==n&&(toggle(ge("app_stat_main_block1_day")),toggle(ge("app_stat_main_block2_day")),toggle(ge("app_stat_main_block3_day")),toggle(ge("app_stat_main_block1_subtitle_day")),toggle(ge("app_stat_main_block1_month")),toggle(ge("app_stat_main_block2_month")),toggle(ge("app_stat_main_block3_month")),toggle(ge("app_stat_main_block1_subtitle_month")),cur.statsMainBlockCurrentPeriodType=n))},chooseVideo:function(e,t){var n={promo:"a_save_promo_video",banner:"a_save_banner_video"},a={promo:"apps_edit_promo_video_thumb",banner:"apps_edit_banner_video_thumb"},r=showBox("al_video.php",{act:"a_choose_video_box",from:"article",app_id:cur.aid},{stat:["page.css","page.js"],cache:1});cur.chooseMedia=function(i,o,s){var c=n[t];return ajax.post("al_apps.php",{act:c,aid:cur.aid,hash:e,video_id:o},{onDone:function(e){if(e)showFastBox({title:getLang("global_error"),dark:1},e);else{r.hide();var n=s.editable&&s.editable.sizes&&s.editable.sizes.l?s.editable.sizes.l[0]:s.thumb,i=ge(a[t]);domData(i,"video-id",o),setStyle(i,"background-image","url('"+n+"')"),show(i)}},onFail:function(e){return showFastBox({title:getLang("global_error"),dark:1},e),!0}}),!1}},showVideo:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=domData(e,"video-id");if(n)return showVideo(n,"",{autoplay:1,queue:1},t)}),removeSelectedVideo:function(e,t,n){var a=ge({promo:"apps_edit_promo_video_thumb",banner:"apps_edit_banner_video_thumb"}[n]),r={promo:"a_save_promo_video",banner:"a_save_banner_video"}[n];return hide(a),ajax.post("al_apps.php",{act:r,aid:cur.aid,hash:e},{onFail:function(e){return showFastBox({title:getLang("global_error"),dark:1},e),show(a),!0}}),cancelEvent(t),!1},hideWarning:function(e,t,n){ajax.post("editapp",{act:"a_hide_warning",app_id:cur.aid,name:t,hash:n},{onDone:function(){hide(geByClass1("app_edit_warning","app_edit_warning_wrap"))}})},getPanoramicBannerSlidesCnt:function(e){return(e=e||ge("apps_featured_slides"))?domChildren(e).length:0},removePanoramicBannerThumb:function(e,t,n,a,r){cancelEvent(t);var i,o={act:"a_remove_panoramic_banner",aid:n,seq:a,hash:r},s=ge("apps_panoramic_banner_error"),c=domCA(e,".apps_featured_thumb"),d=ge("apps_featured_slides"),u=this.getPanoramicBannerSlidesCnt(d)-1,p=window.cur&&cur.panoramicBannerAppsSlider,l=p&&p.indexCurrent||0,_=void 0;return _=(_=Object(_lib_dom_js__WEBPACK_IMPORTED_MODULE_0__.domChildIndex)(c,d)===u)||l===u,window.tooltips&&tooltips.hideAll(),ajax.post("editapp",o,{onFail:function(e){if(s&&e)return s.textContent=e,show(s),!0}}),re(c),(i=this.getPanoramicBannerSlidesCnt(d))?(p&&p.update(),_&&p&&p.prev()):this.hidePanoramicBannerWrapper(),this.canAddNewPanoramicBannerPhoto(d)&&this.enablePanoramicBannerUploadBtn(),i<=1&&this.hideSliderArrows(),!1},addNewPanoramicBannerThumb:function(e){var t=ge("apps_featured_slides"),n=window.cur&&cur.panoramicBannerAppsSlider,a=void 0;t&&(a=domChildren(t).length,t.insertAdjacentHTML("beforeEnd",e),a?(n&&n.update(),n&&n.last()):(n||(this.initPanoramicBannerAppsSlider(),n=window.cur&&cur.panoramicBannerAppsSlider),this.showPanoramicBannerWrapper(),n&&n.prev()),this.getPanoramicBannerSlidesCnt(t)>1&&this.showSliderArrows()),this.canAddNewPanoramicBannerPhoto(t)||this.disablePanoramicBannerUploadBtn()},canAddNewPanoramicBannerPhoto:function(e){return this.getPanoramicBannerSlidesCnt(e)<this.PANORAMIC_SLIDER_MAX_PHOTOS},enablePanoramicBannerUploadBtn:function(){var e=ge("apps_edit_upload_panoramic_banner");e&&removeClass(e,"apps_edit_upload_panoramic_banner_disable")},disablePanoramicBannerUploadBtn:function(){var e=ge("apps_edit_upload_panoramic_banner");e&&addClass(e,"apps_edit_upload_panoramic_banner_disable")},showPanoramicBannerWrapper:function(){var e=ge("apps_edit_panoramic_wrap");removeClass(e,"apps_edit_full_wrap_hidden")},showSliderArrows:function(){var e=ge("apps_featured_slider"),t=geByClass1("apps_featured_prev",e),n=geByClass1("apps_featured_next",e);removeClass(t,"apps_featured_prev_hidden"),removeClass(n,"apps_featured_next_hidden")},hideSliderArrows:function(){var e=ge("apps_featured_slider"),t=geByClass1("apps_featured_prev",e),n=geByClass1("apps_featured_next",e);addClass(t,"apps_featured_prev_hidden"),addClass(n,"apps_featured_next_hidden")},hidePanoramicBannerWrapper:function(){var e=ge("apps_edit_panoramic_wrap");addClass(e,"apps_edit_full_wrap_hidden")},initPanoramicBannerAppsSlider:function(){if(window.Apps&&window.cur&&this.getPanoramicBannerSlidesCnt()){var e=ge("apps_featured_slides");cur.panoramicBannerAppsSlider=window.Apps.makeAppSlider({inner:"apps_featured_slides",outer:"apps_featured_slider",next:"apps_featured_next",prev:"apps_featured_prev",infinite:!1}),cur.panoramicBannerAppsSlider.prev(),this.getPanoramicBannerSlidesCnt(e)<=1&&this.hideSliderArrows()}},initPanoramicBanner:function(){this.initPanoramicBannerAppsSlider();var e=ge("apps_edit_upload_panoramic_banner");addEvent(e,"click",function(e){if(hasClass(this,"apps_edit_upload_panoramic_banner_disable"))return showTitle(this,null,[0,7,0,0],{appendEl:document.body}),void cancelEvent(e)})},slideShow:function(e){isVisible(e)||slideDown(e,150)},slideHide:function(e){isVisible(e)&&slideUp(e,150)},_eof:1};window.AppsEdit=AppsEdit;try{stManager.done("apps_edit.js")}catch(e){}},52:function(e,t,n){"use strict";n.r(t),n.d(t,"vkLocal",function(){return s}),n.d(t,"lTimeout",function(){return c}),n.d(t,"rand",function(){return d}),n.d(t,"irand",function(){return u}),n.d(t,"isUndefined",function(){return p}),n.d(t,"isFunction",function(){return l}),n.d(t,"isArray",function(){return _}),n.d(t,"isString",function(){return f}),n.d(t,"isObject",function(){return v}),n.d(t,"isEmpty",function(){return g}),n.d(t,"vkNow",function(){return h}),n.d(t,"vkImage",function(){return m}),n.d(t,"trim",function(){return w}),n.d(t,"stripHTML",function(){return y}),n.d(t,"escapeRE",function(){return b}),n.d(t,"intval",function(){return C}),n.d(t,"floatval",function(){return A}),n.d(t,"positive",function(){return x}),n.d(t,"isNumeric",function(){return E}),n.d(t,"winToUtf",function(){return k}),n.d(t,"replaceEntities",function(){return S}),n.d(t,"clean",function(){return B}),n.d(t,"unclean",function(){return T}),n.d(t,"each",function(){return D}),n.d(t,"indexOf",function(){return j}),n.d(t,"inArray",function(){return O}),n.d(t,"clone",function(){return P}),n.d(t,"arrayKeyDiff",function(){return F}),n.d(t,"extend",function(){return L}),n.d(t,"addTemplates",function(){return q}),n.d(t,"getTemplate",function(){return M}),n.d(t,"serializeForm",function(){return R}),n.d(t,"extractUrls",function(){return I}),n.d(t,"isRetina",function(){return N}),n.d(t,"getCaretCharacterOffsetWithin",function(){return H}),n.d(t,"formatCount",function(){return V}),n.d(t,"encodeHtml",function(){return Y}),n.d(t,"decodeHtml",function(){return W});var a=n(316),r=n(130),i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function s(e){var t=PageID;return function(){t===PageID&&e.apply(this,arguments)}}function c(e,t){return setTimeout(s(e),t)}window.PageID=window.PageID||1;var d=function(e,t){return Math.random()*(t-e+1)+e},u=function(e,t){return Math.floor(d(e,t))},p=function(e){return void 0===e},l=function(e){return e&&"[object Function]"===Object.prototype.toString.call(e)},_=function(e){return"[object Array]"===Object.prototype.toString.call(e)},f=function(e){return"string"==typeof e},v=function(e){return"[object Object]"===Object.prototype.toString.call(e)};function g(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var h=function(){return+new Date},m=function(){return window.Image?new Image:ce("img")},w=function(e){return(e||"").replace(/^\s+|\s+$/g,"")},y=function(e){return e?e.replace(/<(?:.|\s)*?>/g,""):""},b=function(e){return e?e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"):""};function C(e){return!0===e?1:parseInt(e)||0}function A(e){return!0===e?1:parseFloat(e)||0}function x(e){return(e=C(e))<0?0:e}function E(e){return!isNaN(e)}function k(e){return e.replace(/&#(\d\d+);/g,function(e,t){return(t=C(t))>=32?String.fromCharCode(t):e}).replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")}function S(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return Object(a.se)("<textarea>"+e+"</textarea>").value}function B(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function T(e){return S(e.replace(/\t/g,"\n"))}function D(e,t){if(v(e)||void 0===e.length){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!1===t.call(e[n],n,e[n]))break}else for(var a=0,r=e.length;a<r;a++){var i=e[a];if(!1===t.call(i,a,i))break}return e}function j(e,t,n){for(var a=n||0,r=(e||[]).length;a<r;a++)if(e[a]==t)return a;return-1}function O(e,t){return-1!==j(t,e)}function P(e,t){var n=v(e)||void 0===e.length?{}:[];for(var a in e)(!/webkit/i.test(_ua)||"layerX"!=a&&"layerY"!=a&&"webkitMovementX"!=a&&"webkitMovementY"!=a)&&(t&&"object"===o(e[a])&&"prototype"!==a&&null!==e[a]?n[a]=P(e[a]):n[a]=e[a]);return n}function F(e){var t={},n=arguments.length,a=arguments;for(var r in e)if(e.hasOwnProperty(r)){for(var i=!1,o=1;o<n;o++)a[o][r]&&a[o][r]===e[r]&&(i=!0);i||(t[r]=e[r])}return t}function L(){var e=arguments,t=e.length,n=e[0]||{},a=1,r=!1;for("boolean"==typeof n&&(r=n,n=e[1]||{},a=2),"object"===(void 0===n?"undefined":o(n))||l(n)||(n={});a<t;a++){var i=e[a];if(null!=i)for(var s in i)if(i.hasOwnProperty(s)){var c=n[s],d=i[s];n!==d&&(r&&d&&"object"===(void 0===d?"undefined":o(d))&&!d.nodeType?n[s]=L(r,c||(null!=d.length?[]:{}),d):void 0!==d&&(n[s]=d))}}return n}function q(e){window.templates=window.templates||{},L(window.templates,e)}function M(e,t){var n=(window.templates=window.templates||{})[e];return"function"==typeof n&&(n=n()),n&&t?Object(a.rs)(n,t):n||""}function R(e){if("object"!==(void 0===e?"undefined":o(e)))return!1;var t={},n=function(t){return Object(a.geByTag)(t,e)},r=function(n,r){if(r.name)if("text"!==r.type&&r.type)if(r.getAttribute("bool")){var i=Object(a.val)(r);if(!i||"0"===i)return;t[r.name]=1}else t[r.name]=browser.msie&&!r.value&&e[r.name]?e[r.name].value:r.value;else t[r.name]=Object(a.val)(r)};return D(n("input"),function(e,t){if("radio"!==t.type&&"checkbox"!==t.type||t.checked)return r(0,t)}),D(n("select"),r),D(n("textarea"),r),t}function I(e,t){for(var n=t?/(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$)))/i:/(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0]))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0])))/i,a=void 0,r=[];e&&(a=e.match(n));){e=e.substr(a.index+a[0].length);var i=0;a[4]||(i=7),r.push({url:a[2+i],query:a[5+i]||"",domain:a[4+i]})}return r}var N=function(){return window.devicePixelRatio>=2};function H(e){var t=0,n=0,a=e.ownerDocument||e.document,r=a.defaultView||a.parentWindow;if(r.getSelection().rangeCount>0){var i=r.getSelection().getRangeAt(0),o=i.cloneRange();o.selectNodeContents(e),o.setEnd(i.startContainer,i.startOffset),t=o.toString().length,o.setEnd(i.endContainer,i.endOffset),n=o.toString().length}return[t,n]}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.kLimit||1e3;return e>=(t.mLimit||1e6)&&!t.noCheck?V(e=(e=C(e/1e5))>1e3?C(e/10):e/10,L(t,{noCheck:!0}),!0)+"M":e>=n&&!t.noCheck?V(e=(e=C(e/100))>100?C(e/10):e/10,L(t,{noCheck:!0}),!0)+"K":Object(r.langNumeric)(e,"%s",!0).replace(/,/g,".")}var U,z=i((U=null,[function(e){return U||(U=Object(a.se)("<span> </span>")),U.innerText=e,U.innerHTML.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},function(e){return U||(U=Object(a.se)("<span> </span>")),U.innerHTML=e,U.innerText}]),2),Y=z[0],W=z[1];window.isRetina=N,window.extractUrls=I,window.serializeForm=R,window.addTemplates=q,window.getTemplate=M,window.rand=d,window.irand=u,window.isUndefined=p,window.isFunction=l,window.isArray=_,window.isString=f,window.isObject=v,window.isEmpty=g,window.vkNow=h,window.vkImage=m,window.trim=w,window.stripHTML=y,window.escapeRE=b,window.intval=C,window.floatval=A,window.positive=x,window.isNumeric=E,window.winToUtf=k,window.replaceEntities=S,window.clean=B,window.unclean=T,window.each=D,window.indexOf=j,window.inArray=O,window.clone=P,window.arrayKeyDiff=F,window.extend=L,window.vkLocal=s,window.lTimeout=c,window.getCaretCharacterOffsetWithin=H,window.formatCount=V,window.encodeHtml=Y,window.decodeHtml=W}});